<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#3B82F6">
    <link rel="icon" type="image/png" href="icon.jpeg">


    <title>Stand Out</title>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <!-- Stylesheet will be injected in Message 2 -->
    <style>
        /* ==========================================================
   CORE LAYOUT & BODY
========================================================= */
        body {
            margin: 0;
            font-family: 'Segoe UI', sans-serif;
            background: #0a0a0a;
            color: #fff;
        }

        header {
            text-align: center;
            padding: 2rem;
            background: #001f3f;
        }

        header h1 {
            margin: 0;
            font-size: 2.5rem;
            color: #3B82F6;
        }

        html,
        body {
            height: 100%;
            overflow-y: auto;
            overscroll-behavior: contain;
        }


        /* ===========================
   TOP NAVBAR (Fully fixed + responsive)
=========================== */
        .top-navbar {
            width: 100%;
            height: 60px;
            background: #111827;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 9999;

            display: flex;
            flex-direction: row;
            justify-content: space-between;
            align-items: center;

            padding: 0 16px;

            /* border-bottom: 2px solid #1f2937; */

            /* Prevent wrapping */
            flex-wrap: nowrap;
            white-space: nowrap;
        }

        .nav-left {
            font-size: 1.5rem;
            font-weight: 700;
            color: #3B82F6;
        }

        .nav-right {
            display: flex;
            align-items: center;
            flex-shrink: 0;
            /* prevents shrinking/wrapping */
        }

        .nav-right .nav-img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 2rem;
        }

        /* Prevent content going under navbar */
        /* section {
            margin-top: 70px !important;
        } */


        /* =========================================================
   BOTTOM NAVIGATION
========================================================= */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 55px;
            background: #1f2937;
            display: flex;
            justify-content: space-evenly;
            flex-direction: row;
            align-items: center;
            border-top: 2px solid #111;
            z-index: 50;
        }

        .bottom-nav button {
            flex: 1;
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;
            gap: 6px;
            background: none;
            border: none;
            color: #9ca3af;
            font-size: 14px;
            height: 100%;
            cursor: pointer;
            transition: color 0.2s, transform 0.2s;
        }

        .bottom-nav button:hover {
            color: #3b82f6;
            transform: scale(1.05);
        }

        .bottom-nav button.active {
            color: #3b82f6;
            font-weight: bold;
        }


        /* =========================================================
   PAGE SECTIONS
========================================================= */
        section {
            display: none;
            padding: 1rem 1rem 120px;
            /* üî• increased */
            margin-top: 60px;
            box-sizing: border-box;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.4s ease, transform 0.4s ease;
        }


        /* section {
            min-height: calc(100vh - 55px - 100px);
            height: auto;
        } */

        #account {
            height: auto !important;
            overflow-y: auto !important;
            padding-bottom: 80px !important;
        }

        section.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        .hidden {
            display: none;
        }


        /* =========================================================
   FLOATING + ADD BUTTONS
========================================================= */
        .plus-btn {
            position: fixed;
            bottom: 4.5rem;
            right: 1rem;
            z-index: 100;
            padding: 0.6rem 1.2rem;
            background: #3B82F6;
            border: none;
            border-radius: 6px;
            color: white;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.2s ease;
        }

        .plus-btn:hover {
            background: #2563EB;
            transform: scale(1.05);
        }

        .plus-btn2 {
            position: sticky;
            bottom: 0px;
            margin-top: 1rem;
            padding: 0.6rem 1.2rem;
            background: #3B82F6;
            border: none;
            border-radius: 6px;
            color: white;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.2s ease;
        }


        /* =========================================================
   LIST ITEMS (MISSIONS, SKILLS, GOALS)
========================================================= */
        ul {
            list-style-type: none;
            padding: 0;
        }

        ul li {
            background: #1f2937;
            margin: 0.5rem 0;
            padding: 1rem;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: transform 0.4s ease, opacity 0.4s ease;
        }

        ul li.remove {
            transform: translateX(100%);
            opacity: 0;
            display: none;
        }

        .skill,
        .goal {
            background: #1f2937;
            margin: 0.5rem 0;
            padding: 0.7rem;
            border-radius: 6px;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease, transform 0.5s ease;
            cursor: pointer;
            display: none;
        }

        .skill.show,
        .goal.show {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }


        /* =========================================================
   PROGRESS BARS
========================================================= */
        .progress {
            background: #333;
            border-radius: 4px;
            overflow: hidden;
            height: 10px;
            margin-top: 5px;
        }

        .progress-bar {
            height: 10px;
            background: #3B82F6;
            width: 0%;
            transition: width 0.5s ease;
        }


        /* =========================================================
   BUTTONS (COMPLETE, REMOVE, DANGER)
========================================================= */
        .complete-btn {
            background: transparent;
            border: none;
            color: #3B82F6;
            font-size: 1.5rem;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .complete-btn:hover {
            transform: scale(1.2);
            color: #2563EB;
        }

        .remove-btn,
        .remove-btn2 {
            background: transparent;
            border: none;
            color: #e63946;
            font-size: 1rem;
            cursor: pointer;
            transition: transform 0.2s ease;
            margin-right: 1rem;
        }

        .remove-btn:hover,
        .remove-btn2:hover {
            transform: scale(1.2);
            color: #f87171;
        }



        .danger-btn {
            background: #e63946;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .danger-btn:hover {
            background: #d62828;
        }


        /* =========================================================
   COUNTDOWN TIMER
========================================================= */
        .timer {
            font-size: 1.5rem;
            margin: 1rem 0;
        }


        /* =========================================================
   MODALS (ADD/EDIT, ALERT, CONFIRM)
========================================================= */
        .modal,
        .alert-modal,
        .confirm-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal.active,
        .alert-modal.active,
        .confirm-modal.active {
            display: flex;
        }

        .modal-content,
        .alert-content,
        .confirm-content {
            background: #111827;
            padding: 2rem;
            border-radius: 10px;
            width: 90%;
            max-width: 400px;
            animation: fadeIn 0.3s ease;
        }

        .modal-content h3,
        .alert-content h3,
        .confirm-content h3 {
            margin-top: 0;
            color: #3B82F6;
        }

        .modal-content input,
        .modal-content select {
            width: 100%;
            padding: 0.7rem;
            margin: 0.5rem 0 1rem;
            border-radius: 6px;
            border: none;
            background: #1f2937;
            color: white;
            outline: none;
        }

        .modal-content button,
        .alert-content button,
        .confirm-content button {
            padding: 0.6rem 1rem;
            border: none;
            border-radius: 6px;
            background: #3B82F6;
            color: white;
            cursor: pointer;
            margin-right: 0.5rem;
        }


        /* =========================================================
   POPUPS (MISSION COMPLETE)
========================================================= */
        .popup {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.75);
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .popup-content {
            background: #121212;
            color: #e0e0e0;
            padding: 25px;
            border-radius: 20px;
            text-align: center;
            width: 85%;
            max-width: 320px;
            box-shadow: 0 0 25px #3B82F6;
            transform: scale(0.7);
            opacity: 0;
            animation: popIn 0.4s ease forwards;
        }

        .popup-content h2 {
            margin-bottom: 10px;
            color: #3B82F6;
            font-weight: 600;
            letter-spacing: 1px;
        }

        .popup-content p {
            margin: 8px 0;
            font-size: 15px;
            line-height: 1.4;
        }

        .popup-content button {
            margin-top: 15px;
            padding: 10px 20px;
            background: #3B82F6;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            color: #121212;
            transition: background 0.3s;
        }

        .overdue-badge {
            background: #e63946;
            color: white;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            white-space: nowrap;
            max-width: 100%;
            overflow: hidden;
            text-overflow: ellipsis;
        }


        /* =========================================================
   ACHIEVEMENT POPUP
========================================================= */
        .achievement-popup {
            position: fixed;
            top: 1rem;
            left: 50%;
            transform: translateX(-50%);
            background: #111827;
            color: #3B82F6;
            padding: 1rem 2rem;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            z-index: 9999;
            text-align: center;
            font-weight: bold;
        }

        .achievement-tile {
            width: 120px;
            padding: 10px;
            background: #1f2937;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s, background 0.3s;
        }

        .achievement-tile:hover {
            transform: scale(1.05);
            background: #111827;
        }

        .achievement-icon {
            font-size: 28px;
            margin-bottom: 5px;
            color: #3B82F6;
        }

        .locked .achievement-icon {
            color: #6b7280;
        }

        .achievement-title {
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 3px;
            color: #fff;
        }

        .locked .achievement-title,
        .locked .achievement-desc {
            color: #6b7280;
        }

        .achievement-desc {
            font-size: 12px;
            color: #9ca3af;
        }

        .achievements-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: flex-start;
            padding: 1rem;
        }


        /* =========================================================
   ANIMATIONS
========================================================= */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes popIn {
            0% {
                transform: scale(0.7);
                opacity: 0;
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        @keyframes fadeOut {
            0% {
                transform: scale(1);
                opacity: 1;
            }

            100% {
                transform: scale(0.7);
                opacity: 0;
            }
        }


        /* =========================================================
   MEDIA QUERIES
========================================================= */
        @media (max-width: 768px) {
            nav {
                flex-direction: column;
            }

            nav button {
                width: 100%;
            }

            section {
                padding: 1rem;
            }

            .calendar {
                gap: 0.3rem;
            }

            .day {
                padding: 0.5rem;
            }
        }

        @media (max-width: 450px) {
            .bottom-nav {
                bottom: 0vh;
            }

            .plus-btn {
                bottom: 6.8rem;
            }
        }

        h5 a {
            text-decoration: none;
            color: #3B82F6;
        }

        .goal-subrow {
            display: flex;
            gap: 6px;
            align-items: center;
            flex-wrap: wrap;
            margin-top: 6px;
        }

        .goal-deadline {
            font-size: 12px;
            opacity: 0.7;
            white-space: nowrap;
        }

        .timer-row {
            margin-top: 6px;
        }

        .timer-bar-container {
            width: 100%;
            height: 6px;
            background: #1f2937;
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 6px;
        }

        .timer-bar {
            height: 100%;
            width: 0%;
            background: #3b82f6;
            transition: width 0.3s linear;
        }

        .timer-text {
            font-size: 14px;
            opacity: 0.9;
        }

        .flip-box {
            background: #111;
            padding: 20px 35px;
            border-radius: 10px;
            font-size: 70px;
            font-weight: bold;
            color: #3B82F6;
            box-shadow: 0 0 25px rgba(59, 130, 246, 0.3);
            transform-origin: top;
            transition: transform .6s ease;
        }

        .flip-box.flip {
            transform: rotateX(-90deg);
        }

        .modal,
        .alert-modal,
        .confirm-modal {
            z-index: 100000 !important;
        }

        .flip-container {
            display: flex;
            align-items: center;
            gap: 20px;
            font-family: monospace;
        }

        .colon {
            font-size: 70px;
            color: #3B82F6;
        }

        .flip-unit {
            position: relative;
            width: 90px;
            height: 120px;
            perspective: 300px;
        }

        .flip-card {
            position: absolute;
            width: 100%;
            height: 50%;
            overflow: hidden;
            line-height: 60px;
            font-size: 60px;
            color: #3B82F6;
            background: #111;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.3);
        }

        .top {
            z-index: 2;
        }

        .bottom {
            top: 60px;
        }

        .flip-animate .top {
            animation: flipTop 0.5s linear forwards;
        }

        .flip-animate .bottom {
            animation: flipBottom 0.5s linear forwards;
        }

        @keyframes flipTop {
            0% {
                transform: rotateX(0deg);
            }

            100% {
                transform: rotateX(-90deg);
            }
        }

        @keyframes flipBottom {
            0% {
                transform: rotateX(90deg);
            }

            100% {
                transform: rotateX(0deg);
            }
        }

        /* MODERN NOTIFICATION DRAWER */
        #notificationDrawer {
            position: fixed;
            top: 60px;
            right: 0;
            width: 310px;
            height: calc(100vh - 60px);
            background: #0f172a;
            border: none;
            padding: 1rem;
            overflow-y: auto;
            display: none;
            z-index: 9999;

            box-shadow: -5px 0 25px rgba(0, 0, 0, 0.5);
            animation: slideIn 0.25s ease forwards;
            backdrop-filter: blur(6px);
        }

        /* Smooth slide animation */
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        #notificationDrawer h3 {
            margin-top: 0;
            margin-bottom: 10px;
            color: #3b82f6;
            font-size: 20px;
            font-weight: 700;
            text-align: left;
        }

        /* Clear Button */
        #notificationDrawer button {
            width: 100%;
            padding: 10px;
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 14px;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        #notificationDrawer button:hover {
            background: #dc2626;
        }

        /* Individual notification card */
        .notification-card {
            background: #1e293b;
            padding: 12px 14px;
            margin-bottom: 12px;
            border-radius: 10px;
            border: 1px solid #334155;
            color: #e2e8f0;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);

            transition: transform 0.2s ease, background 0.2s ease;
        }

        .notification-card:hover {
            transform: translateY(-3px);
            background: #0f172a;
        }

        /* Title */
        .notification-card strong {
            color: #3b82f6;
            font-size: 14px;
        }

        /* Message text */
        .notification-card span {
            font-size: 13px;
            opacity: 0.9;
        }

        /* Timestamp */
        .notification-time {
            display: block;
            font-size: 11px;
            opacity: 0.6;
            margin-top: 4px;
        }


        /* FULLSCREEN TIMER SETTINGS MODAL */
        .timer-modal .modal-content {
            width: 40% !important;
            height: 60% !important;
            max-width: none !important;
            max-height: 40% !important;

            background: #000 !important;
            border-radius: 0 !important;
            border: none !important;
            padding: 30px !important;

            display: flex !important;
            flex-direction: column;
            justify-content: center;
            align-items: center;

            animation: fadeIn 0.25s ease;
        }

        /* Inputs Larger */
        .timer-modal input,
        .timer-modal select {
            width: 70%;
            padding: 6px !important;
            font-size: 12px !important;
            margin-bottom: 10px !important;
            background: #111 !important;
            border: 2px solid #3B82F6;
            border-radius: 10px;
        }

        /* Buttons */
        .timer-modal button {
            width: 70%;
            padding: 6px !important;
            font-size: 10px !important;
            border-radius: 12px !important;
            margin-top: 7px;
        }

        /* Header */
        .timer-modal h3 {
            font-size: 25px !important;
            margin-bottom: 30px !important;
        }

        .modal-content label {
            font-size: 15px;
        }

        .static-digit {
            font-size: 90px;
            font-weight: bold;
            font-family: monospace;
            color: #3B82F6;
            width: 90px;
            text-align: center;
        }

        /* FORCE TIMER FULLSCREEN INTO LANDSCAPE ON PHONES */
        @media (max-width: 768px) {
            #timerScreen {
                position: fixed;
                top: 0 !important;
                left: 0 !important;

                width: 100vh !important;
                height: 100vw !important;

                background: #000;

                /* CORRECT ROTATION */
                transform: rotate(90deg) translateX(25%) translateY(50%);
                transform-origin: center center;

                display: flex;
                justify-content: center;
                align-items: center;
                overflow: hidden !important;
                z-index: 999999;
            }

            /* Disable transition animation */
            #musicModal,
            #musicModal *,
            #timerSettingModal,
            #timerSettingModal * {
                transition: none !important;
                animation: none !important;
            }

            /* Rotate instantly */
            #musicModal .modal-content,
            #timerSettingModal .modal-content {
                transform: rotate(90deg);
                transform-origin: center center;
                width: 100vh !important;
                height: 100vw !important;
            }
        }



        #timerScreen .top-right-btns {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: row;
            gap: 18px;
            font-size: 26px;
            cursor: pointer;
            z-index: 2000000;
        }

        #presetControls {
            padding-left: 50px;
            margin-bottom: 10px;
        }


        /* ULTRA COMPACT MOBILE FIX */
        @media (max-width: 600px) {

            #mission-list li {
                flex-direction: column !important;
                align-items: flex-start !important;
                padding: 6px 8px;
                /* compact padding */
                gap: 4px;
            }

            .deadline-row {
                display: flex;
                width: 100%;
                align-items: center;
                justify-content: space-between;
                /* spreads nicely */
                gap: 6px;
                /* small spacing */
            }

            .deadlineDisplay {
                font-size: 12px;
                opacity: 0.85;
                flex-shrink: 0;
                /* prevent squeezing */
                white-space: nowrap;
            }

            .overdueMark {
                font-size: 11px;
                flex-shrink: 0;
                white-space: nowrap;
            }

            .complete-btn {
                font-size: 18px !important;
                padding: 2px 6px !important;
                margin-left: auto;
                /* keeps it right-aligned */
                flex-shrink: 0;
            }
        }

        /* =========================
   MARKETPLACE
========================= */

        .marketplace-sub {
            opacity: 0.7;
            font-size: 14px;
            margin-bottom: 1rem;
        }

        .card-filters {
            display: flex;
            gap: 8px;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .card-filters button {
            background: #111827;
            color: #9ca3af;
            border: 1px solid #1f2937;
            padding: 6px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 13px;
        }

        .card-filters button.active,
        .card-filters button:hover {
            color: #3B82F6;
            border-color: #3B82F6;
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 14px;
            padding-bottom: 80px;
            /* üî• THIS FIXES HIDDEN CARDS */
        }


        /* =========================
   FLEX CARD
========================= */

        .flex-card {
            background: #0b1220;
            border-radius: 14px;
            overflow: hidden;
            position: relative;
            border: 1px solid #1f2937;
            transition: transform 0.25s ease, box-shadow 0.25s ease;
        }

        .flex-card img {
            width: 100%;
            height: 110px;
            object-fit: cover;
            object-position: top;
            filter: contrast(1.1) brightness(0.9);
        }

        .flex-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
        }

        .card-body {
            padding: 10px;
        }

        .flex-card h3 {
            font-size: 14px;
            margin: 0;
            color: #fff;
        }

        .card-quote {
            font-size: 12px;
            opacity: 0.75;
            margin: 6px 0 10px;
            line-height: 1.4;
        }

        .buy-btn {
            width: 100%;
            padding: 6px;
            background: #111827;
            border: 1px solid #3B82F6;
            color: #3B82F6;
            border-radius: 8px;
            font-size: 12px;
            cursor: pointer;
        }

        .buy-btn:hover {
            background: #3B82F6;
            color: #000;
        }

        .grade-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            font-weight: bold;
            font-size: 14px;
            padding: 4px 8px;
            border-radius: 8px;
        }

        /* Grade Colors */
        .grade-s .grade-badge {
            background: gold;
            color: #000;
        }

        .grade-a .grade-badge {
            background: #8b5cf6;
        }

        .grade-b .grade-badge {
            background: #38bdf8;
        }

        .grade-c .grade-badge {
            background: #22c55e;
        }

        .grade-d .grade-badge {
            background: #8B5A2B;
        }

        .grade-e .grade-badge {
            background: #6b7280;
        }

        /* Locked card */
        .flex-card.locked img {
            filter: grayscale(1) brightness(0.5);
        }

        .flex-card.locked .buy-btn {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Owned card */
        .flex-card.owned {
            border-color: #3B82F6;
        }

        .flex-card.owned .buy-btn {
            background: transparent;
            border: none;
            color: #22c55e;
            cursor: default;
        }
         /* Remove blue focus outline */
*:focus {
  outline: none !important;
  box-shadow: none !important;
}

/* Disable blue tap highlight on mobile */
* {
  -webkit-tap-highlight-color: transparent;
}
        .grade-ss .grade-badge {
  background: linear-gradient(45deg, #facc15, #fde047);
  color: #000;
}

.grade-x .grade-badge {
  background: linear-gradient(45deg, #7c3aed, #ec4899);
  color: #fff;
}
        /* =========================
   TOGGLE BUTTON (HARDCORE)
========================= */

.toggle-row {
  display: flex;
  align-items: center;
  gap: 10px;
  margin: 5px 0px 20px 0px;
}

.toggle-label {
  font-size: 14px;
  color: #f87171;
  font-weight: 600;
  user-select: none;
}

/* Switch container */
.toggle {
  position: relative;
  display: inline-block;
  width: 46px;
  height: 24px;
}

/* Hide default checkbox */
.toggle input {
  opacity: 0;
  width: 0;
  height: 0;
}

/* Slider background */
.slider {
  position: absolute;
  cursor: pointer;
  inset: 0;
  background-color: #374151;
  border-radius: 999px;
  transition: background-color 0.25s ease;
}

/* Circle */
.slider::before {
  content: "";
  position: absolute;
  height: 18px;
  width: 18px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  border-radius: 50%;
  transition: transform 0.25s ease;
}

/* ON state */
.toggle input:checked + .slider {
  background-color: #ef4444;
  box-shadow: 0 0 10px rgba(239, 68, 68, 0.6);
}

.toggle input:checked + .slider::before {
  transform: translateX(22px);
}

/* Hover */
.slider:hover {
  background-color: #4b5563;
}
.achievement-date {
    font-size: 11px;
    opacity: 0.6;
    margin-top: 4px;
}
.mint-date {
  font-size: 11px;
  opacity: 0.65;
  margin-top: 4px;
}
/* ===============================
   CHEAT MODAL (APP THEME)
================================ */

.cheat-modal {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.75);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}

.cheat-modal.active {
  display: flex;
}

.cheat-box {
  width: 90%;
  max-width: 360px;
  background: #111827;               /* same as modals */
  border-radius: 12px;
  padding: 1.5rem;
  box-shadow: 0 0 25px rgba(59, 130, 246, 0.35);
  animation: fadeIn 0.3s ease;
}

.cheat-title {
  margin: 0 0 6px;
  font-size: 18px;
  color: #3B82F6;                    /* app primary */
  font-weight: 600;
}

.cheat-desc {
  font-size: 13px;
  opacity: 0.75;
  margin-bottom: 1rem;
}

.cheat-input {
  width: 95%;
  padding: 0.7rem;
  background: #1f2937;
  border: none;
  border-radius: 6px;
  color: white;
  outline: none;
  font-size: 14px;
}

.cheat-input::placeholder {
  color: #9ca3af;
}

.cheat-input:focus {
  outline: 2px solid #3B82F6;
}

.cheat-actions {
  display: flex;
  gap: 10px;
  margin-top: 1.2rem;
}

.cheat-confirm {
  flex: 1;
  background: #3B82F6;
  color: white;
  border: none;
  padding: 0.6rem;
  border-radius: 6px;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.2s;
}

.cheat-confirm:hover {
  background: #2563EB;
}

.cheat-cancel {
  flex: 1;
  background: #1f2937;
  color: #9ca3af;
  border: none;
  padding: 0.6rem;
  border-radius: 6px;
  cursor: pointer;
}

    /* LIMITED EDITION BADGE */
.limited-badge {
  position: absolute;
  top: 10px;
  left: 10px;

  padding: 4px 10px;
  font-size: 11px;
  font-weight: 700;
  letter-spacing: 0.5px;

  color: #0f172a;
  background: linear-gradient(135deg, #facc15, #fde047);

  border-radius: 999px;
  box-shadow: 0 0 12px rgba(250, 204, 21, 0.6);
  z-index: 3;
}
        /* LIMITED CARD BOOST */
.flex-card.limited {
  border: 2px solid #facc15;
  box-shadow:
    0 0 18px rgba(250, 204, 21, 0.35),
    0 0 40px rgba(250, 204, 21, 0.15);
  transform: scale(1.02);
}
        /* EXPIRED OVERLAY */
.expired-overlay {
  position: absolute;
  inset: 0;

  background: rgba(0, 0, 0, 0.65);
  backdrop-filter: blur(2px);

  display: flex;
  align-items: center;
  justify-content: center;

  font-size: 18px;
  font-weight: 800;
  letter-spacing: 2px;
  color: #ef4444;

  z-index: 4;
}
        /* MINT DATE */
.mint-date {
  margin-top: 6px;
  font-size: 11px;
  opacity: 0.75;
  color: #9ca3af;
}
        @keyframes limitedGlow {
  0%   { box-shadow: 0 0 10px rgba(250,204,21,.4); }
  50%  { box-shadow: 0 0 26px rgba(250,204,21,.8); }
  100% { box-shadow: 0 0 10px rgba(250,204,21,.4); }
}

.flex-card.limited:not(.owned) {
  animation: limitedGlow 2.5s infinite ease-in-out;
}
    </style>
</head>

<body>
    <!-- ===========================
       Top Navbar
=========================== -->
    <nav class="top-navbar">
        <div class="nav-left">Stand Out</div>
        <div class="nav-right">
            <!-- üÉè Marketplace Icon -->
            <div id="marketplaceIcon" style="position: relative; margin-right: 1.4rem; cursor:pointer;">
                <i class="fas fa-layer-group" style="font-size:22px; color:#3B82F6;"></i>
            </div>
            <!-- ‚è± Fullscreen Timer Icon -->
            <div id="timerIcon" style="position: relative; margin-right: 1.4rem; cursor:pointer;">
                <i class="fas fa-clock" style="font-size:22px; color:#3B82F6;"></i>
            </div>

            <!-- üîî Notification Bell -->
            <div id="notifyBell" style="position: relative; margin-right: 1.4rem; cursor: pointer;">
                <i class="fas fa-bell" style="font-size: 22px; color: #3B82F6;"></i>

                <!-- Badge -->
                <span id="notifyBadge" style="
                position: absolute;
                top: -6px;
                right: -8px;
                background: red;
                color: white;
                font-size: 11px;
                padding: 2px 5px;
                border-radius: 50%;
                display: none;
              ">
                </span>
            </div>

            <img src="icon.jpeg" alt="Profile" class="nav-img">
            <input type="file" id="importProgressFile" accept=".json" hidden>
        </div>
    </nav>

    <!-- ===========================
       Bottom Navigation
  ============================ -->

    <nav class="bottom-nav">
        <button id="nav-missions" onclick="showPage('missions')">
            <span class="icon"></span><span class="label">Missions</span>
        </button>
        <button id="nav-skillset" onclick="showPage('skillset')">
            <span class="icon"></span><span class="label">Skillset</span>
        </button>
        <button id="nav-time" onclick="showPage('time')">
            <span class="icon"></span><span class="label">Time</span>
        </button>
        <button id="nav-goals" onclick="showPage('goals')">
            <span class="icon"></span><span class="label">Goals</span>
        </button>
        <button id="nav-account" onclick="showPage('account')">
            <span class="icon"></span><span class="label">Account</span>
        </button>
    </nav>


    <!-- ===========================
       Mission Completion Popup
  ============================ -->
    <div id="motivationPopup" class="popup">
        <div class="popup-content">
            <h2 id="popup-title">Mission Complete</h2>
            <p id="motivationQuote"></p>
            <p id="achievement"></p>
            <button onclick="closePopup()">Continue</button>
        </div>

        <audio id="popupSound" src="Complete.mp3" preload="auto"></audio>
    </div>


    <!-- ===========================
       Missions Section
  ============================ -->
    <section id="missions" class="active">
        <h2>Missions</h2>
        <p>Improvement Points: <span id="missionCounter">0</span></p>
        <ul id="mission-list"></ul>
    </section>

    <!-- Floating Add Button -->
    <button class="plus-btn" id="globalAddBtn" onclick="openModal('mission')">+ Add</button>


    <!-- ===========================
       Skillset Section
  ============================ -->
    <section id="skillset">
        <h2>Skillset</h2>
        <div id="skill-list"></div>
    </section>

    <section id="marketplace-cards">
        <h2>Marketplace</h2>
        <p class="marketplace-sub">
            Spend Improvement Points to mint proof of discipline.
        </p>

        <!-- Filter Tabs -->
        <div class="card-filters">
            <button class="active">All</button>
            <button>X</button>
            <button>SS</button>
            <button>S</button>
            <button>A</button>
            <button>B</button>
            <button>C</button>
            <button>D</button>
            <button>E</button>
        </div>

        <!-- Card Grid -->
        <div class="card-grid" id="cardShop"></div>
    </section>

    <!-- <div class="flex-card grade-s locked">
    <img src="cards/iron_discipline.jpg" alt="Iron Discipline">

    <span class="grade-badge">S</span>

    <div class="card-body">
        <h3>Iron Discipline</h3>
        <p class="card-quote">
            ‚ÄúI act even when my mind begs me to stop.‚Äù
        </p>

        <button class="buy-btn">150 pts</button>
    </div>
</div> -->
    <div id="cheatModal" class="cheat-modal">
  <div class="cheat-box">
    <div class="cheat-header">
      üß™ Developer Access
    </div>

    <p class="cheat-subtext">
      Long-press detected. Enter authorization code.
    </p>

    <input 
      id="cheatInput" 
      class="cheat-input"
      placeholder="Enter cheat code"
      autocomplete="off"
    >

    <div class="cheat-actions">
      <button class="cheat-confirm" onclick="confirmCheat()">Unlock</button>
      <button class="cheat-cancel" onclick="closeCheatModal()">Cancel</button>
    </div>
  </div>
    </div>

    <!-- ===========================
       Goals Section
  ============================ -->
    <section id="goals">
        <h2>Goals</h2>
        <div id="goal-list"></div>
    </section>


    <!-- ===========================
       Time / Countdown Section
  ============================ -->
    <section id="time">
        <h2>Time</h2>
        <p>Countdowns: <span id="countdownCounter">0</span></p>
        <div id="countdown-list"></div>
    </section>


    <!-- ===========================
       Account Section
  ============================ -->
    <section id="account" class="hidden">
        <h2>Documentation</h2>

        <h5><a href="documentation.html">Stand Out Version 2.1</a></h5>
        <h5>Date of Documentation: 9 Jan 2026</h5>

        <h3>Achievements</h3>
        <div id="achievementsViewer" style="display: flex; flex-wrap: wrap; gap: 0.5rem;"></div>

        <h3>Backup & Restore</h3>

<button class="danger-btn" style="background:#2563EB; margin-bottom:10px;"
    onclick="saveProgressToFile()">
    üíæ Save Progress
</button>

<button class="danger-btn" style="background:#16a34a;"
    onclick="loadProgressFromFile()">
    üìÇ Restore Progress
</button>

<input type="file" id="importProgressFile" accept=".json" hidden>

        <h3>Reset Data</h3>
        <button id="resetDataBtn" onclick="customConfirm('Are you sure you want to reset all data?', resetData)" class="danger-btn">
            Reset My Data
        </button>
    </section>


    <!-- ===========================
       Modals (Add/Edit + Alert + Confirm)
  ============================ -->
    <div class="modal" id="modal">
        <div class="modal-content" id="modal-content"></div>
    </div>

    <div class="alert-modal" id="alertModal">
        <div class="alert-content">
            <h3 id="alertMsg"></h3>
            <button onclick="closeAlert()">OK</button>
        </div>
    </div>

    <div class="confirm-modal" id="confirmModal">
        <div class="confirm-content">
            <h3 id="confirmMsg"></h3>
            <button onclick="confirmYes()">Yes</button>
            <button onclick="confirmNo()">No</button>
        </div>
    </div>
    <!-- ===========================
    SMART NOTIFICATION POPUP
=========================== -->
    <div id="smartNotify" class="achievement-popup" style="display:none; background:#1f2937; color:#fff;">
        <h3 id="notifyTitle"></h3>
        <p id="notifyMsg"></p>
    </div>
    <!-- ===========================
     Notification Drawer
=========================== -->
    <div id="notificationDrawer" style="
       position: fixed;
       top: 60px;
       right: 0;
       width: 300px;
       height: calc(100vh - 60px);
       background: #1f2937;
       border-left: 2px solid #111;
       padding: 1rem;
       overflow-y: auto;
       display: none;
       z-index: 9999;
     ">
        <h3 style="margin-top:0; color:#3B82F6;">Notifications</h3>
        <button onclick="clearAllNotifications()" style="
            width:100%; 
            padding:8px; 
            background:#e63946; 
            color:white; 
            border:none; 
            border-radius:6px; 
            margin-bottom:10px;">
            Clear All Notifications
        </button>
        <div id="notificationList"></div>
    </div>
    <!-- ===============================
     FULL SCREEN TIMER MODE
================================ -->
    <div id="timerScreen" style="
       display:none;
       position:fixed;
       top:0px; left:0px;
       width:100vw;
       height:100vh;
       background:#000;
       z-index:99999;
       color:white;
       overflow:hidden;
     ">

        <!-- Top-right vertical buttons -->
        <div class="top-right-btns">
            <i id="timerMusicBtn" class="fas fa-music" style="color:#3B82F6;"></i>
            <i id="timerSettingsBtn" class="fas fa-gear" style="color:#3B82F6;"></i>
            <i id="timerCloseBtn" class="fas fa-times" style="color:#3B82F6;"></i>
        </div>

        <!-- Timer -->
        <div id="flipTimer" style="
           position:absolute;
           top:50%; left:50%;
           transform:translate(-50%, -50%);
           font-size:70px;
           font-weight:bold;
           font-family:monospace;
           display:flex;
           gap:20px;
         ">
            <div id="h" class="static-digit">00</div>
            <span class="colon">:</span>
            <div id="m" class="static-digit">00</div>
            <span class="colon">:</span>
            <div id="s" class="static-digit">00</div>
        </div>
    </div>

    <!-- Music Selector Modal -->
    <div id="musicModal" class="modal timer-modal">
        <div class="modal-content">
            <h3>Select Music</h3>

            <!-- Preset wrapper -->
            <div id="presetControls">
                <select id="musicSelect">
                    <option value="m1.mp3">Inception</option>
                    <option value="m2.mp3">Namami Shamishan</option>
                    <option value="m3.mp3">Interstellar</option>
                    <option value="m4.mp3">Oppenheimer</option>
                    <option value="m5.mp3">Lofi</option>
                    <option value="m6.mp3">Demon Slayer</option>
                    <option value="">None</option>
                </select>

                <button id="presetSelectBtn" onclick="setSelectedMusic()">Select</button>
            </div>

            <!-- Folder picker -->
            <button onclick="openFolderPicker()">üìÅ Select Music Folder</button>

            <input type="file" id="folderPicker" webkitdirectory multiple accept="audio/*" style="display:none" />

            <label style="margin-top:10px;">Volume</label>
            <input id="musicVolume" type="range" min="0" max="1" step="0.01" value="1"
                oninput="music.volume = this.value">

            <!-- <button onclick="setSelectedMusic()">Select</button> -->
            <button onclick="closeMusicModal()">Close</button>
        </div>
    </div>

    <!-- Timer Setting Modal -->
    <div id="timerSettingModal" class="modal timer-modal">
        <div class="modal-content">
            <h3>Set Timer</h3>
            <label>Hours</label>
            <input type="number" id="setH" min="0" max="23" value="0">
            <label>Minutes</label>
            <input type="number" id="setM" min="0" max="59" value="25">
            <label>Seconds</label>
            <input type="number" id="setS" min="0" max="59" value="0">

            <button onclick="applyTimerSettings()">Apply</button>
            <button onclick="closeTimerSettingModal()">Close</button>
        </div>
    </div>


    <!-- ===========================
       JavaScript (Message 3)
  ============================ -->

    <script>
        if ("serviceWorker" in navigator) {
            window.addEventListener("load", () => {
                navigator.serviceWorker
                    .register("/service-worker.js")
                    .then(reg => {
                        console.log("‚úÖ Service Worker registered", reg.scope);
                    })
                    .catch(err => {
                        console.error("‚ùå Service Worker failed", err);
                    });
            });
        }
    </script>

    <script>

        function getTodayKey() {
    return new Date().toISOString().slice(0, 10);
        }

        function enforceDailyReset() {
    const today = getTodayKey();

    if (lastImprovementDate !== today) {
        dailyImprovementCount = 0;
        lastImprovementDate = today;

        localStorage.setItem("dailyImprovementCount", "0");
        localStorage.setItem("lastImprovementDate", today);

        console.log("‚úÖ Daily reset enforced:", today);
    }
        }

        window.addEventListener("load", () => {
    enforceDailyReset();
});

        setInterval(enforceDailyReset, 60 * 1000);

function getAppSnapshot() {
    return {
        version: "2.1.0",
        exportedAt: new Date().toISOString(),

        completedMissions,
        dailyImprovementCount,
        lastImprovementDate,

        missions: localStorage.getItem("missions") || "",
        skills: localStorage.getItem("skills") || "",
        goals: localStorage.getItem("goals") || "",

        countdowns: JSON.parse(JSON.stringify(countdowns || [])),
        ownedCards: JSON.parse(JSON.stringify(ownedCards || {})),

        achievements: JSON.parse(JSON.stringify(achievementsData || [])),
        notifications: JSON.parse(JSON.stringify(appNotifications || [])),
        lastNotifCount: Number(localStorage.getItem("lastNotifCount")) || 0
    };
}

        function restoreAppSnapshot(data) {
    resetData(true); // silent reset

    completedMissions = Number(data.completedMissions) || 0;
    dailyImprovementCount = Number(data.dailyImprovementCount) || 0;
    lastImprovementDate = data.lastImprovementDate || new Date().toDateString();

    localStorage.setItem("missions", data.missions || "");
    localStorage.setItem("skills", data.skills || "");
    localStorage.setItem("goals", data.goals || "");

    countdowns = Array.isArray(data.countdowns) ? data.countdowns : [];
    saveCountdowns();

    ownedCards = typeof data.ownedCards === "object" ? data.ownedCards : {};
    localStorage.setItem("ownedCards", JSON.stringify(ownedCards));

    achievementsData = Array.isArray(data.achievements)
        ? data.achievements
        : achievements.map(a => ({ ...a, unlocked: false }));

    localStorage.setItem("achievements", JSON.stringify(achievementsData));

    appNotifications = Array.isArray(data.notifications) ? data.notifications : [];
    localStorage.setItem("appNotifications", JSON.stringify(appNotifications));
    localStorage.setItem("lastNotifCount", data.lastNotifCount || 0);

    localStorage.setItem("completedMissions", completedMissions);
    localStorage.setItem("dailyImprovementCount", dailyImprovementCount);
    localStorage.setItem("lastImprovementDate", lastImprovementDate);

    loadData();
    renderAchievements();
    renderCountdowns();
    renderMarketplace();
    renderMyCards();
    updateNotificationBadge();

    document.getElementById("missionCounter").textContent = completedMissions;
        }
        
function saveProgressToFile() {

    const snapshot = getAppSnapshot();
    const blob = new Blob(
        [JSON.stringify(snapshot, null, 2)],
        { type: "application/json" }
    );

    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = `standout-backup-${Date.now()}.json`;

    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);

    URL.revokeObjectURL(a.href);
}

function loadProgressFromFile() {
    customConfirm(
        "Restoring will overwrite your current progress. Continue?",
        () => document.getElementById("importProgressFile").click()
    );
}

        document.getElementById("importProgressFile").addEventListener("change", function (e) {
    const file = e.target.files[0];
    if (!file) return;

    const reader = new FileReader();

    reader.onload = () => {
        try {
            const text = reader.result.replace(/^\uFEFF/, "").trim();
            const data = JSON.parse(text);
            console.log("RAW FILE TEXT:", reader.result);
            console.log("PARSED DATA:", data);

            restoreAppSnapshot(data);
            customAlert("Progress restored successfully!");
        } catch (err) {
            console.error("Restore failed:", err);
            customAlert("Invalid or corrupted backup file.");
        }
    };

    reader.readAsText(file);
    e.target.value = "";
});

        window.saveProgressToFile = saveProgressToFile;
window.loadProgressFromFile = loadProgressFromFile;
        
        const DAILY_IMPROVEMENT_LIMIT = 10;

        let dailyImprovementCount = parseInt(localStorage.getItem("dailyImprovementCount")) || 0;
        let lastImprovementDate = localStorage.getItem("lastImprovementDate") || new Date().toDateString();

        function resetDailyImprovementIfNeeded() {
    const today = new Date().toDateString();

    if (lastImprovementDate !== today) {
        localStorage.setItem("dailyImprovementCount", "0");
        localStorage.setItem("lastImprovementDate", today);
    }

    // üîê Always sync from storage after reset
    dailyImprovementCount =
        parseInt(localStorage.getItem("dailyImprovementCount")) || 0;
    lastImprovementDate =
        localStorage.getItem("lastImprovementDate") || today;
        }


        let isMarketplaceOpen = false;


        const cardCatalog = [


{
  id: "blackbeard",
  title: "Marshall D. Teach",
  quote: "People‚Äôs dreams never end!",
  grade: "SS",
  cost: 186,
  image: "Images/SS1.jpg"
},
{
  id: "imu",
  title: "Imu",
  quote: "Erase them from history.",
  grade: "SS",
  cost: 189,
  image: "Images/SS2.jpg"
},
{
  id: "doflamingo",
  title: "Donquixote Doflamingo",
  quote: "Whoever wins becomes justice.",
  grade: "SS",
  cost: 155,
  image: "Images/SS3.jpg"
},
{
  id: "kaido",
  title: "Kaido",
  quote: "Death completes a person.",
  grade: "SS",
  cost: 160,
  image: "Images/SS4.jpg"
},
{
  id: "roger",
  title: "Gol D. Roger",
  quote: "My treasure? You can have it.",
  grade: "SS",
  cost: 201,
  image: "Images/SS5.jpg"
},
{
  id: "loki",
  title: "Loki",
  quote: "Strength decides everything.",
  grade: "SS",
  cost: 164,
  image: "Images/SS6.jpg"
},
{
  id: "xebec",
  title: "Rocks D. Xebec",
  quote: "The world itself is my enemy.",
  grade: "SS",
  cost: 199,
  image: "Images/SS7.jpg"
},
{
  id: "rayleigh",
  title: "Silvers Rayleigh",
  quote: "Living isn‚Äôt about following rules.",
  grade: "SS",
  cost: 175,
  image: "Images/SS8.jpg"
},
{
  id: "gaban",
  title: "Scopper Gaban",
  quote: "The Pirate King‚Äôs crew fears nothing.",
  grade: "SS",
  cost: 169,
  image: "Images/SS9.jpg"
},
{
  id: "whitebeard",
  title: "Edward Newgate",
  quote: "One Piece‚Ä¶ is real!",
  grade: "SS",
  cost: 176,
  image: "Images/SS10.jpg"
},
{
  id: "aizen",
  title: "Sosuke Aizen",
  quote: "Admiration is the furthest thing from understanding.",
  grade: "SS",
  cost: 146,
  image: "Images/SS11.jpg"
},
{
  id: "zeno",
  title: "Zeno",
  quote: "Erase!",
  grade: "SS",
  cost: 156,
  image: "Images/SS12.jpg"
},
{
  id: "denji",
  title: "Denji",
  quote: "I just want a normal life.",
  grade: "SS",
  cost: 150,
  image: "Images/SS13.jpg"
},
{ id: "luffy", 
title: "Monkey D. Luffy", 
quote: "I‚Äôm gonna be King of the Pirates!", 
grade: "SS", cost: 156, 
image: "Images/SS14.jpg" },
  {
    id: "shanks",
    title: "Shanks",
    quote: "It‚Äôs okay to cry‚Ä¶ but you have to move on.",
    grade: "SS",
    cost: 159,
    image: "Images/SS15.jpg"
  },
    
  {
    id: "garp",
    title: "Monkey D. Garp",
    quote: "Training is the only thing that never betrays you.",
    grade: "S",
    cost: 104,
    image: "Images/S1.jpg"
  },
  {
    id: "dragon",
    title: "Monkey D. Dragon",
    quote: "The world is waiting for our answer.",
    grade: "S",
    cost: 102,
    image: "Images/S2.jpg"
  },
  {
    id: "zoro",
    title: "Roronoa Zoro",
    quote: "If I can‚Äôt even protect my captain‚Äôs dream, then whatever ambition I have is nothing but talk.",
    grade: "S",
    cost: 111,
    image: "Images/S3.jpg"
  },
  {
    id: "sanji",
    title: "Sanji",
    quote: "Cooking is a gift from the gods.",
    grade: "S",
    cost: 103,
    image: "Images/S4.jpg"
  },
  {
    id: "jimbei",
    title: "Jimbei",
    quote: "What matters is not the past, but the future.",
    grade: "S",
    cost: 99,
    image: "Images/S5.jpg"
  },
  {
    id: "vegapunk",
    title: "Dr. Vegapunk",
    quote: "Science exists for the benefit of humanity.",
    grade: "S",
    cost: 99,
    image: "Images/S6.jpg"
  },
  {
    id: "lucci",
    title: "Rob Lucci",
    quote: "I kill because it‚Äôs my job.",
    grade: "S",
    cost: 106,
    image: "Images/S7.jpg"
  },
  {
    id: "katakuri",
    title: "Charlotte Katakuri",
    quote: "If you want to surpass me‚Ä¶ see the future.",
    grade: "S",
    cost: 140,
    image: "Images/S8.jpg"
  },
  {
    id: "momonosuke",
    title: "Kozuki Momonosuke",
    quote: "I am the man who will become Shogun of Wano!",
    grade: "S",
    cost: 145,
    image: "Images/S9.jpg"
  },
  {
    id: "usopp",
    title: "Usopp",
    quote: "I‚Äôm a brave warrior of the sea!",
    grade: "S",
    cost: 101,
    image: "Images/S10.jpg"
  },
  {
    id: "mihawk",
    title: "Dracule Mihawk",
    quote: "Power determines everything.",
    grade: "S",
    cost: 112,
    image: "Images/S11.jpg"
  },
  {
    id: "marco",
    title: "Marco",
    quote: "Relax‚Ä¶ we‚Äôve got your back.",
    grade: "S",
    cost: 126,
    image: "Images/S12.jpg"
  },
  {
    id: "yamato",
    title: "Yamato",
    quote: "I am Kozuki Oden!",
    grade: "S",
    cost: 128,
    image: "Images/S13.jpg"
  },
  {
    id: "ging",
    title: "Ging Freecss",
    quote: "You should enjoy the little detours.",
    grade: "S",
    cost: 92,
    image: "Images/S14.jpg"
  },
  {
    id: "oden",
    title: "Kozuki Oden",
    quote: "I was born to boil!",
    grade: "S",
    cost: 126,
    image: "Images/S15.jpg"
  },
  {
    id: "goku",
    title: "Goku",
    quote: "I am the hope of the universe!",
    grade: "S",
    cost: 129,
    image: "Images/S16.jpg"
  },
  {
    id: "tanjiro",
    title: "Tanjiro Kamado",
    quote: "I won‚Äôt forgive you.",
    grade: "S",
    cost: 102,
    image: "Images/S17.jpg"
  },
  {
    id: "muzan",
    title: "Muzan Kibutsuji",
    quote: "Perfection is survival.",
    grade: "S",
    cost: 103,
    image: "Images/S18.jpg"
  },
  {
    id: "shikamaru",
    title: "Shikamaru Nara",
    quote: "How troublesome.",
    grade: "S",
    cost: 110,
    image: "Images/S19.jpg"
  },
  {
    id: "naruto",
    title: "Naruto Uzumaki",
    quote: "I never go back on my word!",
    grade: "S",
    cost: 130,
    image: "Images/S20.jpg"
  },
  {
    id: "madara",
    title: "Madara Uchiha",
    quote: "Wake up to reality.",
    grade: "S",
    cost: 109,
    image: "Images/S21.jpg"
  },
  {
    id: "all_for_one",
    title: "All For One",
    quote: "Heroes exist because of villains.",
    grade: "S",
    cost: 136,
    image: "Images/S22.jpg"
  },
  {
    id: "all_might",
    title: "All Might",
    quote: "I am here!",
    grade: "S",
    cost: 137,
    image: "Images/S23.jpg"
  },
  {
    id: "going_merry",
    title: "Going Merry",
    quote: " I'm sorry... I wanted to carry you even farther... But I was happy. You always treated me well. THANK YOU! I was always so happy! ",
    grade: "S",
    cost: 150,
    image: "Images/S24.jpg"
  },
  {
    id: "hashirama",
    title: "Hashirama Senju",
    quote: "Protect the village.",
    grade: "S",
    cost: 135,
    image: "Images/S25.jpg"
  },
  {
    id: "meruem",
    title: "Meruem",
    quote: "What is the value of life?",
    grade: "S",
    cost: 132,
    image: "Images/S26.jpg"
  },
  {
    id: "thousand_sunny",
    title: "Thousand Sunny",
    quote: "",
    grade: "S",
    cost: 150,
    image: "Images/S27.jpg"
  },
{
  id: "ichigo",
  title: "Ichigo Kurosaki",
  quote: "If I can‚Äôt protect them, I won‚Äôt forgive myself.",
  grade: "S",
  cost: 124,
  image: "Images/S28.jpg"
},
{
  id: "ryuma",
  title: "Ryuma",
  quote: "A sword reflects its master.",
  grade: "S",
  cost: 102,
  image: "Images/S29.jpg"
},{
  id: "akainu",
  title: "Akainu",
  quote: "Absolute justice.",
  grade: "S",
  cost: 109,
  image: "Images/S30.jpg"
},
{
  id: "beckman",
  title: "Benn Beckman",
  quote: "Think before you move.",
  grade: "S",
  cost: 123,
  image: "Images/S31.jpg"
},
            {
  id: "yasopp",
  title: "Yasopp",
  quote: "A pirate never misses.",
  grade: "S",
  cost: 100,
  image: "Images/S32.jpg"
},{
  id: "lucky_roux",
  title: "Lucky Roux",
  quote: "Guess I‚Äôll eat.",
  grade: "S",
  cost: 120,
  image: "Images/S33.jpg"
},{
  id: "magellan",
  title: "Magellan",
  quote: "Poison is absolute.",
  grade: "S",
  cost: 100,
  image: "Images/S34.jpg"
},{
  id: "king",
  title: "King",
  quote: "I‚Äôll never lose again.",
  grade: "S",
  cost: 120,
  image: "Images/S35.jpg"
},
    {
  id: "corazon",
  title: "Donquixote Rosinante",
  quote: "I love you.",
  grade: "B",
  cost: 53,
  image: "Images/B1.jpg"
},

{
  id: "oven",
  title: "Charlotte Oven",
  quote: "I‚Äôll burn everything!",
  grade: "B",
  cost: 62,
  image: "Images/B2.jpg"
},

{
  id: "jack",
  title: "Jack",
  quote: "I never retreat.",
  grade: "B",
  cost: 65,
  image: "Images/B3.jpg"
},

{
  id: "page_one",
  title: "Page One",
  quote: "I follow orders.",
  grade: "B",
  cost: 63,
  image: "Images/B4.jpg"
},

{
  id: "izou",
  title: "Izou",
  quote: "This is the way of the samurai.",
  grade: "B",
  cost: 76,
  image: "Images/B5.jpg"
},

{
  id: "kuma",
  title: "Bartholomew Kuma",
  quote: "If you were to take a trip‚Ä¶ where would you go?",
  grade: "B",
  cost: 76,
  image: "Images/B6.jpg"
},

{
  id: "kizaru",
  title: "Kizaru",
  quote: "Scary, scary.",
  grade: "B",
  cost: 78,
  image: "Images/B7.jpg"
},

{
  id: "hyogoro",
  title: "Hyogoro",
  quote: "Haki blooms in battle.",
  grade: "B",
  cost: 63,
  image: "Images/B8.jpg"
},

{
  id: "kenpachi",
  title: "Kenpachi Zaraki",
  quote: "Fighting is fun.",
  grade: "B",
  cost: 63,
  image: "Images/B9.jpg"
},

{
  id: "urahara",
  title: "Kisuke Urahara",
  quote: "That‚Äôs interesting.",
  grade: "B",
  cost: 78,
  image: "Images/B10.jpg"
},

{
  id: "sasuke",
  title: "Sasuke Uchiha",
  quote: "I will sever all bonds.",
  grade: "B",
  cost: 63,
  image: "Images/B11.jpg"
},

{
  id: "giyu",
  title: "Giyu Tomioka",
  quote: "I am not like you.",
  grade: "B",
  cost: 67,
  image: "Images/B12.jpg"
},

{
  id: "tamayo",
  title: "Tamayo",
  quote: "I seek redemption.",
  grade: "B",
  cost: 69,
  image: "Images/B13.jpg"
},

{
  id: "akaza",
  title: "Akaza",
  quote: "Become stronger.",
  grade: "B",
  cost: 79,
  image: "Images/B14.jpg"
},

{
  id: "killua",
  title: "Killua Zoldyck",
  quote: "Gon, you are light.",
  grade: "B",
  cost: 78,
  image: "Images/B15.jpg"
},

{
  id: "kurapika",
  title: "Kurapika",
  quote: "My chains bind evil.",
  grade: "B",
  cost: 78,
  image: "Images/B16.jpg"
},

{
  id: "illumi",
  title: "Illumi Zoldyck",
  quote: "Control is love.",
  grade: "B",
  cost: 68,
  image: "Images/B17.jpg"
},

{
  id: "shikaku",
  title: "Shikaku Nara",
  quote: "Think three steps ahead.",
  grade: "B",
  cost: 78,
  image: "Images/B18.jpg"
},

{
  id: "byakuya",
  title: "Byakuya Kuchiki",
  quote: "Pride is everything.",
  grade: "B",
  cost: 76,
  image: "Images/B19.jpg"
},

{
  id: "yamamoto",
  title: "Genryusai Yamamoto",
  quote: "Burn to ash.",
  grade: "B",
  cost: 78,
  image: "Images/B20.jpg"
},

{
  id: "endeavor",
  title: "Endeavor",
  quote: "I will surpass him.",
  grade: "B",
  cost: 78,
  image: "Images/B21.jpg"
},

{
  id: "stain",
  title: "Stain",
  quote: "Fake heroes disgust me.",
  grade: "B",
  cost: 76,
  image: "Images/B22.jpg"
},{
  id: "eraser_head",
  title: "Eraser Head",
  quote: "Heroes don‚Äôt need applause.",
  grade: "B",
  cost: 62,
  image: "Images/B23.jpg"
},
    {
  id: "hawkins",
  title: "Basil Hawkins",
  quote: "Fate is absolute.",
  grade: "C",
  cost: 32,
  image: "Images/C1.jpg"
},

{
  id: "xdrake",
  title: "X Drake",
  quote: "Justice isn‚Äôt always clean.",
  grade: "C",
  cost: 36,
  image: "Images/C2.jpg"
},

{
  id: "bartolomeo",
  title: "Bartolomeo",
  quote: "Luffy-senpai!",
  grade: "C",
  cost: 56,
  image: "Images/C3.jpg"
},

{
  id: "smoker",
  title: "Smoker",
  quote: "Justice isn‚Äôt black and white.",
  grade: "C",
  cost: 58,
  image: "Images/C4.jpg"
},

{
  id: "ivankov",
  title: "Ivankov",
  quote: "Love is freedom!",
  grade: "C",
  cost: 52,
  image: "Images/C5.jpg"
},

{
  id: "kyros",
  title: "Kyros",
  quote: "A father never gives up.",
  grade: "C",
  cost: 53,
  image: "Images/C6.jpg"
},

{
  id: "zeff",
  title: "Zeff",
  quote: "Never waste food.",
  grade: "C",
  cost: 46,
  image: "Images/C7.jpg"
},

{
  id: "roshi",
  title: "Master Roshi",
  quote: "Train hard, rest harder.",
  grade: "C",
  cost: 46,
  image: "Images/C8.jpg"
},

{
  id: "uraraka",
  title: "Ochaco Uraraka",
  quote: "Who protects the heroes?",
  grade: "C",
  cost: 46,
  image: "Images/C9.jpg"
},

{
  id: "todoroki",
  title: "Shoto Todoroki",
  quote: "It‚Äôs my power.",
  grade: "C",
  cost: 59,
  image: "Images/C10.jpg"
},

{
  id: "iida",
  title: "Tenya Iida",
  quote: "Rules exist for a reason!",
  grade: "C",
  cost: 56,
  image: "Images/C11.jpg"
},

{
  id: "hawks",
  title: "Hawks",
  quote: "I want an easy life.",
  grade: "C",
  cost: 63,
  image: "Images/C12.jpg"
},

{
  id: "dabi",
  title: "Dabi",
  quote: "Burn it all.",
  grade: "C",
  cost: 53,
  image: "Images/C13.jpg"
},

{
  id: "overhaul",
  title: "Overhaul",
  quote: "Cleanliness is justice.",
  grade: "C",
  cost: 54,
  image: "Images/C14.jpg"
},

{
  id: "leorio",
  title: "Leorio Paradinight",
  quote: "I want to save lives.",
  grade: "C",
  cost: 56,
  image: "Images/C15.jpg"
},

{
  id: "hisoka",
  title: "Hisoka",
  quote: "I‚Äôm turned on.",
  grade: "C",
  cost: 32,
  image: "Images/C16.jpg"
},

{
  id: "doma",
  title: "Doma",
  quote: "Everything feels empty.",
  grade: "C",
  cost: 46,
  image: "Images/C17.jpg"
},

{
  id: "goku_black",
  title: "Goku Black",
  quote: "Justice shall prevail.",
  grade: "C",
  cost: 32,
  image: "Images/C18.jpg"
},

{
  id: "hitsugaya",
  title: "Toshiro Hitsugaya",
  quote: "Freeze.",
  grade: "C",
  cost: 56,
  image: "Images/C19.jpg"
},
            {
  id: "orochimaru",
  title: "Orochimaru",
  quote: "Life is meaningless without knowledge.",
  grade: "D",
  cost: 36,
  image: "Images/D1.jpg"
},
{
  id: "bakugo",
  title: "Katsuki Bakugo",
  quote: "I‚Äôll win!",
  grade: "D",
  cost: 46,
  image: "Images/D2.jpg"
},

{
  id: "tokoyami",
  title: "Fumikage Tokoyami",
  quote: "Darkness answers my call.",
  grade: "D",
  cost: 32,
  image: "Images/D3.jpg"
},

{
  id: "amajiki",
  title: "Tamaki Amajiki",
  quote: "I‚Äôm not confident‚Ä¶",
  grade: "D",
  cost: 35,
  image: "Images/D4.jpg"
},
{
  id: "krillin",
  title: "Krillin",
  quote: "I won‚Äôt give up!",
  grade: "D",
  cost: 36,
  image: "Images/D5.jpg"
},

{
  id: "buggy",
  title: "Buggy",
  quote: "I‚Äôm gonna be Pirate King!",
  grade: "D",
  cost: 23,
  image: "Images/D6.jpg"
},
    {
  id: "nami",
  title: "Nami",
  quote: "Money can buy happiness.",
  grade: "X",
  cost: 69,
  image: "Images/X1.jpg"
},

{
  id: "robin",
  title: "Nico Robin",
  quote: "I want to live!",
  grade: "X",
  cost: 69,
  image: "Images/X2.jpg"
},

{
  id: "boa",
  title: "Boa Hancock",
  quote: "Whatever I do‚Ä¶ will be forgiven.",
  grade: "X",
  cost: 69,
  image: "Images/X3.jpg"
},

{
  id: "pudding",
  title: "Charlotte Pudding",
  quote: "I hate you‚Ä¶ I love you.",
  grade: "X",
  cost: 69,
  image: "Images/X4.jpg"
},

{
  id: "black_maria",
  title: "Black Maria",
  quote: "Pain makes love deeper.",
  grade: "X",
  cost: 69,
  image: "Images/X5.jpg"
},

{
  id: "ulti",
  title: "Ulti",
  quote: "Say it properly!",
  grade: "X",
  cost: 69,
  image: "Images/X6.jpg"
},

{
  id: "bonney",
  title: "Jewelry Bonney",
  quote: "I‚Äôll take back what‚Äôs mine.",
  grade: "X",
  cost: 69,
  image: "Images/X7.jpg"
},

{
  id: "linlin",
  title: "Linlin",
  quote: "Life or treat!",
  grade: "X",
  cost: 69,
  image: "Images/X8.jpg"
},

{
  id: "reiju",
  title: "Reiju",
  quote: "Kindness is strength.",
  grade: "X",
  cost: 69,
  image: "Images/X9.jpg"
},

{
  id: "bulma",
  title: "Bulma",
  quote: "I‚Äôm a genius, you know.",
  grade: "X",
  cost: 69,
  image: "Images/X10.jpg"
},

{
  id: "orihime",
  title: "Orihime Inoue",
  quote: "I want to protect everyone.",
  grade: "X",
  cost: 69,
  image: "Images/X11.jpg"
},
{
  id: "tsunade",
  title: "Tsunade",
  quote: "I am the Hokage.",
  grade: "X",
  cost: 69,
  image: "Images/X12.jpg"
},

{
  id: "shiba",
  title: "Ichigo Shiba",
  quote: "I‚Äôll protect everyone.",
  grade: "X",
  cost: 69,
  image: "Images/X13.jpg"
},

{
  id: "rangiku",
  title: "Rangiku Matsumoto",
  quote: "Life should be enjoyed.",
  grade: "X",
  cost: 69,
  image: "Images/X14.jpg"
},

{
  id: "rebecca",
  title: "Rebecca",
  quote: "I will fight!",
  grade: "X",
  cost: 69,
  image: "Images/X15.jpg"
},

{
  id: "power",
  title: "Power",
  quote: "I am the strongest!",
  grade: "X",
  cost: 69,
  image: "Images/X16.jpg"
},

{
  id: "reze",
  title: "Reze",
  quote: "Do you like bombs?",
  grade: "X",
  cost: 69,
  image: "Images/X17.jpg"
},

{
  id: "midnight",
  title: "Midnight",
  quote: "Youth is passion!",
  grade: "X",
  cost: 69,
  image: "Images/X18.jpg"
},

{
  id: "yaoyorozu",
  title: "Momo Yaoyorozu",
  quote: "I will do my best.",
  grade: "X",
  cost: 69,
  image: "Images/X19.jpg"
},

{
  id: "mitsuri",
  title: "Mitsuri Kanroji",
  quote: "Love is my strength!",
  grade: "X",
  cost: 69,
  image: "Images/X20.jpg"
},

{
  id: "shinobu",
  title: "Shinobu Kocho",
  quote: "Ara ara.",
  grade: "X",
  cost: 69,
  image: "Images/X21.jpg"
},

{
  id: "nezuko",
  title: "Nezuko Kamado",
  quote: "Mm!",
  grade: "X",
  cost: 69,
  image: "Images/X22.jpg"
},

{
  id: "rukia",
  title: "Rukia Kuchiki",
  quote: "Trust yourself.",
  grade: "X",
  cost: 69,
  image: "Images/X23.jpg"
},

{
  id: "temari",
  title: "Temari",
  quote: "Strategy decides battles.",
  grade: "X",
  cost: 69,
  image: "Images/X24.jpg"
},
            {
  id: "vegeta",
  title: "Vegeta",
  quote: "I am the prince of all Saiyans!",
  grade: "A",
  cost: 79,
  image: "Images/A1.jpg"
},

{
  id: "brook",
  title: "Brook",
  quote: "May I see your panties?",
  grade: "A",
  cost: 102,
  image: "Images/A2.jpg"
},

{
  id: "chopper",
  title: "Tony Tony Chopper",
  quote: "I‚Äôm not a monster‚Ä¶ I‚Äôm a doctor!",
  grade: "A",
  cost: 95,
  image: "Images/A3.jpg"
},

{
  id: "franky",
  title: "Franky",
  quote: "SUPER!",
  grade: "A",
  cost: 92,
  image: "Images/A4.jpg"
},

{
  id: "ace",
  title: "Portgas D. Ace",
  quote: "Thank you‚Ä¶ for loving me.",
  grade: "A",
  cost: 95,
  image: "Images/A5.jpg"
},

{
  id: "cracker",
  title: "Charlotte Cracker",
  quote: "Pain is weakness.",
  grade: "A",
  cost: 76,
  image: "Images/A6.jpg"
},

{
  id: "perospero",
  title: "Charlotte Perospero",
  quote: "Lick, lick!",
  grade: "A",
  cost: 73,
  image: "Images/A7.jpg"
},

{
  id: "queen",
  title: "Queen",
  quote: "Zoom zoom zoom!",
  grade: "A",
  cost: 81,
  image: "Images/A8.jpg"
},

{
  id: "inuarashi",
  title: "Inuarashi",
  quote: "We fight together!",
  grade: "A",
  cost: 87,
  image: "Images/A9.jpg"
},

{
  id: "carrot",
  title: "Carrot",
  quote: "I want to see the world!",
  grade: "A",
  cost: 88,
  image: "Images/A10.jpg"
},

{
  id: "kinemon",
  title: "Kin‚Äôemon",
  quote: "Loyalty is my way of life.",
  grade: "A",
  cost: 82,
  image: "Images/A11.jpg"
},

{
  id: "kiku",
  title: "Kikunojo",
  quote: "My heart is that of a samurai.",
  grade: "A",
  cost: 89,
  image: "Images/A12.jpg"
},

{
  id: "pedro",
  title: "Pedro",
  quote: "Everyone gets their time to shine.",
  grade: "A",
  cost: 87,
  image: "Images/A13.jpg"
},

{
  id: "law",
  title: "Trafalgar Law",
  quote: "I hate bread.",
  grade: "A",
  cost: 94,
  image: "Images/A14.jpg"
},

{
  id: "hajrudin",
  title: "Hajrudin",
  quote: "Giants never kneel!",
  grade: "A",
  cost: 97,
  image: "Images/A15.jpg"
},

{
  id: "dorry",
  title: "Dorry",
  quote: "We fight with honor!",
  grade: "A",
  cost: 93,
  image: "Images/A16.jpg"
},

{
  id: "brogy",
  title: "Brogy",
  quote: "Warriors never regret!",
  grade: "A",
  cost: 93,
  image: "Images/A17.jpg"
},

{
  id: "crocodile",
  title: "Crocodile",
  quote: "Trust is weakness.",
  grade: "A",
  cost: 93,
  image: "Images/A18.jpg"
},

{
  id: "bon_clay",
  title: "Bon Clay",
  quote: "Friendship has no borders!",
  grade: "A",
  cost: 99,
  image: "Images/A19.jpg"
},

{
  id: "fujitora",
  title: "Fujitora",
  quote: "I want to see the world.",
  grade: "A",
  cost: 88,
  image: "Images/A20.jpg"
},

{
  id: "killer_b",
  title: "Killer B",
  quote: "Fool, ya fool!",
  grade: "A",
  cost: 98,
  image: "Images/A21.jpg"
},

{
  id: "gaara",
  title: "Gaara",
  quote: "Love saves.",
  grade: "A",
  cost: 93,
  image: "Images/A22.jpg"
},

{
  id: "isshin",
  title: "Isshin Kurosaki",
  quote: "Protect your family.",
  grade: "A",
  cost: 98,
  image: "Images/A23.jpg"
},

{
  id: "aokiji",
  title: "Aokiji",
  quote: "Lazy justice.",
  grade: "A",
  cost: 89,
  image: "Images/A24.jpg"
},

{
  id: "minato",
  title: "Minato Namikaze",
  quote: "I‚Äôll protect everyone.",
  grade: "A",
  cost: 96,
  image: "Images/A25.jpg"
},

{
  id: "koby",
  title: "Koby",
  quote: "I want to become an admiral!",
  grade: "A",
  cost: 89,
  image: "Images/A26.jpg"
},

{
  id: "nekomamushi",
  title: "Nekomamushi",
  quote: "Let‚Äôs party!",
  grade: "A",
  cost: 86,
  image: "Images/A27.jpg"
},
            {
  id: "tobirama",
  title: "Tobirama Senju",
  quote: "Power must be controlled.",
  grade: "A",
  cost: 93,
  image: "Images/A28.jpg"
},

{
  id: "uryu",
  title: "Uryu Ishida",
  quote: "Pride defines a Quincy.",
  grade: "A",
  cost: 98,
  image: "Images/A29.jpg"
},

{
  id: "chad",
  title: "Yasutora Sado",
  quote: "My fists exist only to protect.",
  grade: "A",
  cost: 99,
  image: "Images/A30.jpg"
},

{
  id: "pain",
  title: "Pain",
  quote: "This world shall know pain.",
  grade: "A",
  cost: 96,
  image: "Images/A31.jpg"
},

{
  id: "youpi",
  title: "Menthuthuyoupi",
  quote: "Rage is power.",
  grade: "A",
  cost: 92,
  image: "Images/A32.jpg"
},

{
  id: "jiraiya",
  title: "Jiraiya",
  quote: "The tale of Jiraiya the Gallant.",
  grade: "A",
  cost: 93,
  image: "Images/A33.jpg"
},

{
  id: "beerus",
  title: "Beerus",
  quote: "Destruction is my job.",
  grade: "A",
  cost: 95,
  image: "Images/A34.jpg"
},

{
  id: "midoriya",
  title: "Izuku Midoriya",
  quote: "This is my story!",
  grade: "A",
  cost: 94,
  image: "Images/A35.jpg"
},

{
  id: "shigaraki",
  title: "Tomura Shigaraki",
  quote: "Everything decays.",
  grade: "A",
  cost: 98,
  image: "Images/A36.jpg"
},

{
  id: "zenitsu",
  title: "Zenitsu Agatsuma",
  quote: "I don‚Äôt want to die!",
  grade: "A",
  cost: 96,
  image: "Images/A37.jpg"
},

{
  id: "inosuke",
  title: "Inosuke Hashibira",
  quote: "I‚Äôm the strongest!",
  grade: "A",
  cost: 93,
  image: "Images/A38.jpg"
},

{
  id: "rengoku",
  title: "Kyojuro Rengoku",
  quote: "Set your heart ablaze!",
  grade: "A",
  cost: 81,
  image: "Images/A39.jpg"
},

{
  id: "kokushibo",
  title: "Kokushibo",
  quote: "Strength is eternal.",
  grade: "A",
  cost: 83,
  image: "Images/A40.jpg"
},

{
  id: "gon",
  title: "Gon Freecss",
  quote: "I want to see my dad.",
  grade: "A",
  cost: 98,
  image: "Images/A41.jpg"
},

{
  id: "pitou",
  title: "Neferpitou",
  quote: "I must protect the king.",
  grade: "A",
  cost: 98,
  image: "Images/A42.jpg"
},

{
  id: "chrollo",
  title: "Chrollo Lucilfer",
  quote: "Identity is meaningless.",
  grade: "A",
  cost: 98,
  image: "Images/A43.jpg"
},

{
  id: "shaiapouf",
  title: "Shaiapouf",
  quote: "The king is everything.",
  grade: "A",
  cost: 91,
  image: "Images/A44.jpg"
},

{
  id: "sabo",
  title: "Sabo",
  quote: "I won‚Äôt let anyone take away my freedom.",
  grade: "A",
  cost: 89,
  image: "Images/A45.jpg"
        },
{
  id: "hado",
  title: "Nejire Hado",
  quote: "That‚Äôs amazing!",
  grade: "E",
  cost: 9,
  image: "Images/E2.jpg"
},
{
  id: "apoo",
  title: "Scratchmen Apoo",
  quote: "Music is my weapon!",
  grade: "E",
  cost: 6,
  image: "Images/E1.jpg"
},
        {
  id: "reze",
  title: "Reze",
  grade: "X",
  cost: 69,
  image: "Images/X17.jpg",

  limited: true,
  expiresAt: "2026-01-09T23:55:09Z"
        }    
        ];



        let ownedCards = JSON.parse(localStorage.getItem("ownedCards")) || {};

        function renderMarketplace(filterGrade = "ALL") {
  const shop = document.getElementById("cardShop");
  if (!shop) return;

  shop.innerHTML = "";

  let cards = [...cardCatalog];

  if (filterGrade !== "ALL") {
    cards = cards.filter(c => c.grade === filterGrade);
  }

  // ‚úÖ SINGLE SORT (safe)
  cards.sort((a, b) => {
    const aLimited = a.limited ? 1 : 0;
    const bLimited = b.limited ? 1 : 0;
    if (aLimited !== bLimited) return bLimited - aLimited;

    const aOwned = ownedCards[a.id] ? 1 : 0;
    const bOwned = ownedCards[b.id] ? 1 : 0;
    if (aOwned !== bOwned) return bOwned - aOwned;

    const aCanBuy = completedMissions >= a.cost ? 1 : 0;
    const bCanBuy = completedMissions >= b.cost ? 1 : 0;
    if (aCanBuy !== bCanBuy) return bCanBuy - aCanBuy;

    return gradeRank(b.grade) - gradeRank(a.grade);
  });

  cards.forEach(card => {
    const isOwned = !!ownedCards[card.id];
    const expired = isExpired(card);

    if (expired && !isOwned) return;

    const canBuy = completedMissions >= card.cost;
    const mintDate =
      isOwned && ownedCards[card.id]?.mintedAt
        ? formatDate(ownedCards[card.id].mintedAt)
        : "";

    const div = document.createElement("div");
    div.className = `
      flex-card
      grade-${card.grade.toLowerCase()}
      ${isOwned ? "owned" : "locked"}
      ${card.limited ? "limited" : ""}
    `;

      div.innerHTML = `
  <img src="${card.image}">
  <span class="grade-badge">${card.grade}</span>

  ${card.limited ? `<span class="limited-badge">LIMITED</span>` : ""}

  <div class="card-body">
    <h3>${card.title}</h3>
    <p class="card-quote">${card.quote}</p>

    ${
      isOwned
        ? `<button class="buy-btn" disabled>OWNED</button>`
        : `<button class="buy-btn" ${!canBuy ? "disabled" : ""}>
             ${card.cost} pts
           </button>`
    }

    ${isOwned && mintDate ? `<div class="mint-date">Minted on ${mintDate}</div>` : ""}
  </div>
`;
    

    if (!isOwned && canBuy && !expired) {
      div.querySelector(".buy-btn").onclick = () => buyCard(card.id);
    }

    shop.appendChild(div);
  });
        }


        function isExpired(card) {
  if (!card.limited) return false;
  if (!card.expiresAt) return false;

  return Date.now() > new Date(card.expiresAt).getTime();
        }
            function buyCard(cardId) {
  const card = cardCatalog.find(c => c.id === cardId);
  if (!card) return;

  // ‚ùå Prevent minting expired limited cards
  if (card.limited && isExpired(card)) {
    customAlert("This limited edition card is no longer available.");
    return;
  }

  if (completedMissions < card.cost) {
    customAlert("Not enough Improvement Points.");
    return;
  }

  customConfirm(
    `Mint "${card.title}" for ${card.cost} points?\nThis is permanent.`,
    () => {
      completedMissions -= card.cost;
      document.getElementById("missionCounter").textContent = completedMissions;

      ownedCards[card.id] = {
        mintedAt: new Date().toISOString()   // ‚úÖ ISO format
      };

      localStorage.setItem("ownedCards", JSON.stringify(ownedCards));
      localStorage.setItem("completedMissions", completedMissions);

      renderMarketplace();
      renderMyCards();

      showSmartNotification(
        "Card Minted",
        `"${card.title}" is now part of your identity.`
      );
    }
  );
            }

        function formatDate(isoDate) {
    if (!isoDate) return "";
    const d = new Date(isoDate);
    return d.toLocaleDateString([], {
        day: "numeric",
        month: "short",
        year: "numeric"
    });
        }

        function renderMyCards() {
            const container = document.getElementById("ownedCards");
            if (!container) return;

            container.innerHTML = "";

            const ownedList = cardCatalog
                .filter(card => ownedCards[card.id])
                .sort((a, b) => gradeRank(b.grade) - gradeRank(a.grade));

            if (ownedList.length === 0) {
                container.innerHTML = `<p style="opacity:.6;">No cards minted yet.</p>`;
                return;
            }

            ownedList.forEach(card => {
                const data = ownedCards[card.id];

                const div = document.createElement("div");
                div.className = `flex-card owned grade-${card.grade.toLowerCase()}`;

                div.innerHTML = `
    <img src="${card.image}" alt="${card.title}">
    <span class="grade-badge">${card.grade}</span>

    <div class="card-body">
        <h3>${card.title}</h3>
        <p class="card-quote">${card.quote}</p>

        ${
            isOwned
                ? `
                  <p class="mint-date">
                      Minted on ${mintedAt}
                  </p>
                  <button class="buy-btn" disabled>OWNED</button>
                `
                : `
                  <button class="buy-btn" ${!canBuy ? "disabled" : ""}>
                      ${card.cost} pts
                  </button>
                `
        }
    </div>
`;


                container.appendChild(div);
            });
        }

        const GRADE_ORDER = ["E", "D", "C", "B", "A", "X", "S", "SS"];

function gradeRank(grade) {
  return GRADE_ORDER.indexOf(grade) + 1;
}

        document.querySelectorAll(".card-filters button").forEach(btn => {
            btn.onclick = () => {
                document.querySelectorAll(".card-filters button")
                    .forEach(b => b.classList.remove("active"));

                btn.classList.add("active");

                const grade = btn.textContent === "All"
                    ? "ALL"
                    : btn.textContent;

                renderMarketplace(grade);
            };
        });

        window.addEventListener("load", () => {
            renderMarketplace();
            renderMyCards();
        });


        document.getElementById("marketplaceIcon").onclick = () => {
            if (isMarketplaceOpen) {
                // Close marketplace ‚Üí go back to missions (or last page)
                showPage("missions");
                isMarketplaceOpen = false;
            } else {
                // Open marketplace
                showPage("marketplace-cards");
                isMarketplaceOpen = true;
            }
        };


        document.getElementById("timerCloseBtn").onclick = () => {
            document.getElementById("timerScreen").style.display = "none";
            document.querySelector(".top-navbar").style.display = "flex";
            document.querySelector(".bottom-nav").style.display = "flex";

            clearInterval(timerInterval);
            stopAllMusic();
        };


        let playlist = [];
        let currentTrackIndex = 0;
        let timerInterval = null;
        let currentMusic = null;
        let music = new Audio();

        function stopAllMusic() {
            if (music) {
                music.pause();
                music.currentTime = 0;
                music.onended = null;
            }
        }


        function openFolderPicker() {
            const picker = document.getElementById("folderPicker");
            if (picker) {
                picker.click();
            } else {
                console.error("‚ùå folderPicker not found");
            }
        }

        document.getElementById("folderPicker").addEventListener("change", function (e) {
            stopAllMusic();

            const files = Array.from(e.target.files)
                .filter(file => file.type.startsWith("audio/"));

            if (files.length === 0) {
                customAlert("No audio files found in this folder.");
                return;
            }

            playlist = files;
            musicMode = "playlist";
            currentTrackIndex = 0;

            // hidePresetUI(); // üî• HIDE preset controls

            customConfirm(
                `Play ${playlist.length} songs from this folder?`,
                () => {
                    playCurrentTrack();
                    closeMusicModal();
                }
            );

            e.target.value = "";
        });


        function resumeMusicOnUserGesture() {
            const resume = () => {
                music.play().catch(() => { });
                document.removeEventListener("click", resume);
                document.removeEventListener("touchstart", resume);
            };

            document.addEventListener("click", resume);
            document.addEventListener("touchstart", resume);
        }


        function playCurrentTrack() {
            if (musicMode !== "playlist") return;
            if (!playlist[currentTrackIndex]) return;

            const file = playlist[currentTrackIndex];
            const url = URL.createObjectURL(file);

            music.src = url;
            music.loop = false;
            music.volume = document.getElementById("musicVolume").value;

            music.play()
                .then(() => { })
                .catch(() => {
                    // üî• FIX autoplay block
                    resumeMusicOnUserGesture();
                });

            music.onended = () => {
                if (musicMode !== "playlist") return;

                currentTrackIndex++;
                if (currentTrackIndex >= playlist.length) {
                    currentTrackIndex = 0;
                }
                playCurrentTrack();
            };
        }



        function setSelectedMusic() {
            stopAllMusic();

            const file = document.getElementById("musicSelect").value;
            if (!file) return;

            musicMode = "preset";
            playlist = [];
            currentTrackIndex = 0;

            showPresetUI(); // ‚úÖ RESTORE HERE

            music.src = file;
            music.loop = true;
            music.volume = document.getElementById("musicVolume").value;

            music.play().catch(() => { });
            closeMusicModal();
        }




        function showPresetUI() {
            document.getElementById("presetControls").style.display = "block";
        }

        function hidePresetUI() {
            document.getElementById("presetControls").style.display = "none";
        }


        let musicMode = "preset"; // "preset" | "playlist"



        // =========================
        //   NOTIFICATION SYSTEM
        // =========================

        let appNotifications = JSON.parse(localStorage.getItem("appNotifications")) || [];

        // Save notif list
        function saveNotifications() {
            localStorage.setItem("appNotifications", JSON.stringify(appNotifications));
        }

        // Add new notification
        function pushNotification(title, msg) {
            appNotifications.unshift({
                title,
                msg,
                time: new Date().toLocaleString()
            });

            updateNotificationBadge();
            saveNotifications();
        }
        function clearAllNotifications() {
            appNotifications = [];                 // Clear array
            localStorage.removeItem("appNotifications"); // Remove from localStorage
            localStorage.removeItem("lastNotifCount");   // Reset unread count tracker

            // Update UI
            document.getElementById("notificationList").innerHTML =
                `<p style="opacity:0.6;">No notifications</p>`;

            const badge = document.getElementById("notifyBadge");
            badge.style.display = "none";
            badge.textContent = "";

            console.log("All notifications cleared.");
        }

        // Update badge count
        function updateNotificationBadge() {
            const badge = document.getElementById("notifyBadge");
            if (!badge) return;

            const lastCount = parseInt(localStorage.getItem("lastNotifCount")) || 0;

            const unread = appNotifications.length - lastCount;

            if (unread <= 0) {
                badge.style.display = "none";
            } else {
                badge.style.display = "inline-block";
                badge.textContent = unread;
            }
        }

        // Open/Close drawer
        document.getElementById("notifyBell").onclick = (e) => {
            e.stopPropagation();
            const drawer = document.getElementById("notificationDrawer");

            if (drawer.style.display === "none") {
                renderNotifications();
                drawer.style.display = "block";

                // üî• Clear the badge
                const badge = document.getElementById("notifyBadge");
                // Clear badge
                badge.style.display = "none";
                badge.textContent = "";

                // Mark all as read (but keep them in list)
                // Reset unread count
                localStorage.setItem("lastNotifCount", appNotifications.length);
                updateNotificationBadge();
                saveNotifications();
            } else {
                drawer.style.display = "none";
            }
        }; // ‚Üê CLOSE THIS PROPERLY

        document.getElementById("notificationDrawer").addEventListener("click", function (e) {
            e.stopPropagation();
        });


        document.addEventListener("click", function () {
            const drawer = document.getElementById("notificationDrawer");
            if (drawer && drawer.style.display === "block") {
                drawer.style.display = "none";
            }
        });



        // ----------------------------
        // NOW define renderNotifications
        // ----------------------------
        function renderNotifications() {
            const container = document.getElementById("notificationList");
            container.innerHTML = "";

            if (appNotifications.length === 0) {
                container.innerHTML = `<p style="opacity:0.7; text-align:center;">No notifications</p>`;
                return;
            }

            appNotifications.forEach(n => {
                const div = document.createElement("div");
                div.className = "notification-card";

                div.innerHTML = `
            <strong>${n.title}</strong><br>
            <span>${n.msg}</span>
            <span class="notification-time">${n.time}</span>
        `;

                container.appendChild(div);
            });
        }

        // Initialize badge on load
        window.addEventListener("load", updateNotificationBadge);

        function showSmartNotification(title, message) {
            const popup = document.getElementById("smartNotify");
            document.getElementById("notifyTitle").innerText = title;
            document.getElementById("notifyMsg").innerText = message;

            popup.style.display = "block";
            popup.style.opacity = 0;
            popup.style.transform = "translateY(-40px)";

            setTimeout(() => {
                popup.style.transition = "all 0.4s ease";
                popup.style.opacity = 1;
                popup.style.transform = "translateY(0)";
            }, 20);

            // auto hide
            setTimeout(() => {
                popup.style.opacity = 0;
                popup.style.transform = "translateY(-40px)";
                setTimeout(() => popup.style.display = "none", 400);
            }, 3000);
        }

        function dailyGoalReminder() {
            const today = new Date().toDateString();
            const lastRun = localStorage.getItem("dailyGoalReminder");

            if (lastRun === today) return; // already sent today

            localStorage.setItem("dailyGoalReminder", today);

            const goals = document.querySelectorAll("#goal-list .goal");
            goals.forEach(goal => {
                const title = goal.querySelector(".goal-title")?.textContent;
                if (title) {
                    pushNotification("Goal Reminder", `Don't forget your goal: "${title}"`);
                }
            });
        }

        /* =========================================================
       1. GLOBAL VARIABLES + STORED DATA
    ========================================================= */
        let completedMissions = parseInt(localStorage.getItem("completedMissions")) || 0;
        let missionHistory = JSON.parse(localStorage.getItem("missionHistory")) || {};
        window.addEventListener("load", () => {
            checkMissedDeadlines();
        });


        document.getElementById("missionCounter").textContent = completedMissions;


        /* =========================================================
           2. ACHIEVEMENTS SYSTEM
        ========================================================= */

        // Achievement definitions
        const achievements = [
            { id: "mission1", title: "First Step", desc: "Complete your very first mission", unlocked: false },
            { id: "mission5", title: "On a Roll", desc: "Complete 5 missions", unlocked: false },
            { id: "mission10", title: "Mission Master", desc: "Complete 10 missions", unlocked: false },
            { id: "mission15", title: "Halfway Hero", desc: "Complete 15 missions", unlocked: false },
            { id: "mission20", title: "Goal Getter", desc: "Complete 20 missions", unlocked: false },
            { id: "mission25", title: "Silver Streak", desc: "Complete 25 missions", unlocked: false },
            { id: "mission30", title: "Mission Maestro", desc: "Complete 30 missions", unlocked: false },
            { id: "mission35", title: "Trailblazer", desc: "Complete 35 missions", unlocked: false },
            { id: "mission40", title: "Achievement Hunter", desc: "Complete 40 missions", unlocked: false },
            { id: "mission45", title: "Mission Veteran", desc: "Complete 45 missions", unlocked: false },
            { id: "mission50", title: "Legendary Milestone", desc: "Complete 50 missions", unlocked: false },
            { id: "mission55", title: "Mastermind", desc: "Complete 55 missions", unlocked: false },
            { id: "mission60", title: "Champion", desc: "Complete 60 missions", unlocked: false },
            { id: "mission65", title: "Pathfinder", desc: "Complete 65 missions", unlocked: false },
            { id: "mission70", title: "Mission Conqueror", desc: "Complete 70 missions", unlocked: false },
            { id: "mission75", title: "Epic Endeavor", desc: "Complete 75 missions", unlocked: false },
            { id: "mission80", title: "Trail Master", desc: "Complete 80 missions", unlocked: false },
            { id: "mission85", title: "Ultimate Achiever", desc: "Complete 85 missions", unlocked: false },
            { id: "mission90", title: "Hero of Tasks", desc: "Complete 90 missions", unlocked: false },
            { id: "mission95", title: "Task Titan", desc: "Complete 95 missions", unlocked: false },
            { id: "mission100", title: "Century Club", desc: "Complete 100 missions", unlocked: false },
            { id: "mission105", title: "Beyond Limits", desc: "Complete 105 missions", unlocked: false },
            { id: "mission110", title: "Relentless", desc: "Complete 110 missions", unlocked: false },
            { id: "mission115", title: "Sky High", desc: "Complete 115 missions", unlocked: false },
            { id: "mission120", title: "Goal Crusher", desc: "Complete 120 missions", unlocked: false },
            { id: "mission125", title: "Mission Marathoner", desc: "Complete 125 missions", unlocked: false },
            { id: "mission130", title: "Infinite Drive", desc: "Complete 130 missions", unlocked: false },
            { id: "mission135", title: "Peak Performer", desc: "Complete 135 missions", unlocked: false },
            { id: "mission140", title: "Legend in Making", desc: "Complete 140 missions", unlocked: false },
            { id: "mission145", title: "Champion of Tasks", desc: "Complete 145 missions", unlocked: false },
            { id: "mission150", title: "Task Legend", desc: "Complete 150 missions", unlocked: false },
            { id: "mission155", title: "Milestone Achiever", desc: "Complete 155 missions", unlocked: false },
            { id: "mission160", title: "Mission Icon", desc: "Complete 160 missions", unlocked: false },
            { id: "mission165", title: "Epic Journey", desc: "Complete 165 missions", unlocked: false },
            { id: "mission170", title: "Task Champion", desc: "Complete 170 missions", unlocked: false },
            { id: "mission175", title: "Master of Milestones", desc: "Complete 175 missions", unlocked: false },
            { id: "mission180", title: "Legendary Achiever", desc: "Complete 180 missions", unlocked: false },
            { id: "mission185", title: "Ultimate Victor", desc: "Complete 185 missions", unlocked: false },
            { id: "mission190", title: "Task Hero", desc: "Complete 190 missions", unlocked: false },
            { id: "mission195", title: "Mission Elite", desc: "Complete 195 missions", unlocked: false },
            { id: "mission200", title: "Two Hundred Triumphs", desc: "Complete 200 missions", unlocked: false },
            { id: "mission205", title: "Beyond Achievement", desc: "Complete 205 missions", unlocked: false },
            { id: "mission210", title: "Victory Streak", desc: "Complete 210 missions", unlocked: false },
            { id: "mission215", title: "Unstoppable", desc: "Complete 215 missions", unlocked: false },
            { id: "mission220", title: "Peak Achiever", desc: "Complete 220 missions", unlocked: false },
            { id: "mission225", title: "Mission Overlord", desc: "Complete 225 missions", unlocked: false },
            { id: "mission230", title: "Epic Victor", desc: "Complete 230 missions", unlocked: false },
            { id: "mission235", title: "Champion of Goals", desc: "Complete 235 missions", unlocked: false },
            { id: "mission240", title: "Task Mastermind", desc: "Complete 240 missions", unlocked: false },
            { id: "mission245", title: "Legendary Hero", desc: "Complete 245 missions", unlocked: false },
            { id: "mission250", title: "Ultimate Legend", desc: "Complete 250 missions", unlocked: false }
        ];

        // Load achievements from storage
        let achievementsData = JSON.parse(localStorage.getItem("achievements"));
        if (!achievementsData) {
            achievementsData = achievements;
            localStorage.setItem("achievements", JSON.stringify(achievements));
        }

        const quotes = [
            "Discipline is the bridge between goals and achievement.",
            "Consistency creates progress, progress creates success.",
            "Small steps every day lead to big results.",
            "Effort today becomes strength tomorrow.",
            "Stay focused, stay strong, keep moving forward.",
            "Success is the sum of small efforts repeated daily.",
            "Your only limit is your mind.",
            "Great things never come from comfort zones.",
            "Dream it. Believe it. Achieve it.",
            "Push yourself, because no one else is going to do it for you.",
            "The harder you work for something, the greater you‚Äôll feel when you achieve it.",
            "Don‚Äôt stop when you‚Äôre tired. Stop when you‚Äôre done.",
            "Focus on progress, not perfection.",
            "Your future is created by what you do today, not tomorrow.",
            "Small progress is still progress.",
            "Motivation gets you started, habit keeps you going.",
            "Do something today that your future self will thank you for.",
            "Success doesn‚Äôt come from what you do occasionally, it comes from what you do consistently.",
            "Believe in yourself and all that you are.",
            "Take the risk or lose the chance."
        ];

        /* Render achievements in account page */
        function renderAchievements() {
            const container = document.getElementById("achievementsViewer");
            if (!container) return;

            container.innerHTML = "";

            const unlocked = achievementsData.filter(a => a.unlocked);
            const locked = achievementsData.filter(a => !a.unlocked).slice(0, 5);
            const displayList = [...unlocked, ...locked];

            displayList.forEach(ach => {
                const div = document.createElement("div");
                div.className = "achievement-tile" + (ach.unlocked ? "" : " locked");

                const icon = ach.unlocked
                    ? '<i class="fas fa-trophy"></i>'
                    : '<i class="fas fa-lock"></i>';

                div.innerHTML = `
  <div class="achievement-icon">${icon}</div>
  <div class="achievement-title">${ach.title}</div>
  <div class="achievement-desc">${ach.desc}</div>

  ${
    ach.unlocked && ach.unlockedAt
      ? `<div class="achievement-date">
           Achieved on: ${ach.unlockedAt}
         </div>`
      : ""
  }
`;

                container.appendChild(div);
            });
        }

        /* Unlock an achievement */
        function unlockAchievement(id) {
    const ach = achievementsData.find(a => a.id === id);

    if (ach && !ach.unlocked) {
        ach.unlocked = true;
        ach.unlockedAt = new Date().toDateString(); // üî• ADD THIS

        localStorage.setItem("achievements", JSON.stringify(achievementsData));

        pushNotification("üèÜ New Achievement", `You unlocked: "${ach.title}"`);
        showAchievementPopup(ach.title, ach.desc);
        renderAchievements();
    }
        }

        function showAchievementPopup(title, desc) {
            window.isAchievementPlaying = true;

            const popup = document.createElement("div");
            popup.className = "achievement-popup";
            popup.innerHTML = `<h3>${title}</h3><p>${desc}</p>`;
            document.body.appendChild(popup);

            const audio = new Audio("Achievements.mp3");
            audio.volume = 0.5;
            audio.play().catch(() => { });

            audio.onended = () => { window.isAchievementPlaying = false; };

            popup.style.opacity = 0;
            popup.style.transform = "translateY(-50px)";
            setTimeout(() => {
                popup.style.transition = "all 0.5s ease";
                popup.style.opacity = 1;
                popup.style.transform = "translateY(0)";
            }, 10);

            setTimeout(() => {
                popup.style.opacity = 0;
                popup.style.transform = "translateY(-50px)";
                setTimeout(() => popup.remove(), 500);
            }, 3000);
        }


        /* =========================================================
           3. NAVIGATION SYSTEM
        ========================================================= */
        function showPage(pageId) {
            document.querySelectorAll("section").forEach(sec =>
                sec.classList.remove("active")
            );

            const page = document.getElementById(pageId);
            if (page) page.classList.add("active");

            document.querySelectorAll(".bottom-nav > button")
                .forEach(b => b.classList.remove("active"));

            const btn = document.getElementById("nav-" + pageId);
            if (btn) btn.classList.add("active");

            updatePlusBtn(pageId);

            isMarketplaceOpen = (pageId === "marketplace-cards");


            if (pageId === "account") renderAchievements();
        }

        function updatePlusBtn(pageId) {
            const btn = document.getElementById("globalAddBtn");
            if (!btn) return;

            if (pageId === "missions") {
                btn.setAttribute("onclick", "openModal('mission')");
                btn.style.display = "block";
            } else if (pageId === "skillset") {
                btn.setAttribute("onclick", "openModal('skill')");
                btn.style.display = "block";
            } else if (pageId === "goals") {
                btn.setAttribute("onclick", "openModal('goal')");
                btn.style.display = "block";
            } else if (pageId === "time") {
                btn.setAttribute("onclick", "openModal('multi-time')");
                btn.style.display = "block";
            } else {
                btn.style.display = "none";
            }
        }
        // ===============================
        // FULLSCREEN TIMER MODE JS
        // ===============================



        // OPEN FULL SCREEN
        document.getElementById("timerIcon").onclick = () => {
            document.getElementById("timerScreen").style.display = "block";
            document.querySelector(".top-navbar").style.display = "none";
            document.querySelector(".bottom-nav").style.display = "none";
        };

        // EXIT FULL SCREEN
        document.getElementById("timerCloseBtn").onclick = () => {
            document.getElementById("timerScreen").style.display = "none";
            document.querySelector(".top-navbar").style.display = "flex";
            document.querySelector(".bottom-nav").style.display = "flex";

            clearInterval(timerInterval);

            music.pause();
            music.currentTime = 0;
        };


        // MUSIC MODAL
        document.getElementById("timerMusicBtn").onclick = () => {
            document.getElementById("musicModal").classList.add("active");

            if (musicMode === "preset") {
                showPresetUI();
            }
        };

        function closeMusicModal() {
            document.getElementById("musicModal").classList.remove("active");
        }
        // function setSelectedMusic() {
        //     let file = document.getElementById("musicSelect").value;
        //     currentMusic = file;
        //     music.src = file;
        //     music.loop = true;
        //     music.volume = document.getElementById("musicVolume").value;
        //     music.play();
        //     closeMusicModal();
        // }

        // SETTINGS MODAL
        document.getElementById("timerSettingsBtn").onclick = () => {
            document.getElementById("timerSettingModal").classList.add("active");
        };

        function closeTimerSettingModal() {
            document.getElementById("timerSettingModal").classList.remove("active");
        }

        // Apply timer settings
        function applyTimerSettings() {
            let h = parseInt(document.getElementById("setH").value);
            let m = parseInt(document.getElementById("setM").value);
            let s = parseInt(document.getElementById("setS").value);

            startStaticTimer(h, m, s);
            closeTimerSettingModal();
        }


        function startStaticTimer(h, m, s) {
            clearInterval(timerInterval);

            let total = h * 3600 + m * 60 + s;

            // Set initial values
            document.getElementById("h").textContent = h.toString().padStart(2, "0");
            document.getElementById("m").textContent = m.toString().padStart(2, "0");
            document.getElementById("s").textContent = s.toString().padStart(2, "0");

            timerInterval = setInterval(() => {
                if (total <= 0) {
                    clearInterval(timerInterval);
                    if (currentMusic) music.pause();
                    return;
                }

                total--;

                const hh = Math.floor(total / 3600);
                const mm = Math.floor((total % 3600) / 60);
                const ss = total % 60;

                document.getElementById("h").textContent = hh.toString().padStart(2, "0");
                document.getElementById("m").textContent = mm.toString().padStart(2, "0");
                document.getElementById("s").textContent = ss.toString().padStart(2, "0");

            }, 1000);
        }




        /* =========================================================
           4. MODALS (ADD / EDIT / ALERT / CONFIRM)
        ========================================================= */
        function openModal(type, skillDiv = null) {
            const modal = document.getElementById("modal");
            const content = document.getElementById("modal-content");

            modal.classList.add("active");

            // ---- Add Mission ----
            if (type === 'mission') {
                const skills = [...document.querySelectorAll("#skill-list strong")]
                    .map(s => `<option value="${s.textContent}">${s.textContent}</option>`)
                    .join("");

                content.innerHTML = `
  <h3>Add Mission</h3>
  <input id="missionInput" placeholder="Enter mission">

  <label>Link Skill</label>
  <select id="linkedSkill">
    <option value="">None</option>
    ${skills}
  </select>

  <label>Deadline</label>
  <input id="missionDeadline" type="datetime-local">

  <div class="toggle-row">
  <label class="toggle">
    <input type="checkbox" id="hardcoreToggle">
    <span class="slider"></span>
  </label>
  <span class="toggle-label">Hardcore Mode</span>
</div>

  <button onclick="addMission()">Add</button>
  <button onclick="closeModal()">Cancel</button>
`;

            }

            // ---- Edit Mission ----
            if (type === "edit-mission" && skillDiv) {
    const oldText = skillDiv.querySelector(".mission-text").textContent.replace("üî•", "").trim();
    const oldDeadline = skillDiv.dataset.deadline || "";
    const isHardcore = skillDiv.dataset.hardcore === "true";

    content.innerHTML = `
      <h3>Edit Mission</h3>

      <input id="editMissionInput" value="${oldText}">

      <label>Deadline</label>
      <input 
        id="editMissionDeadline" 
        type="datetime-local" 
        value="${oldDeadline}"
        ${isHardcore ? "disabled" : ""}
      >

      ${
        isHardcore
          ? `<p style="color:#ef4444;font-size:12px;margin-top:6px;">
              üî• Hardcore mission ‚Äî deadline cannot be changed
            </p>`
          : ""
      }

      <button onclick="updateMission()">Update</button>

      ${
        isHardcore
          ? `<button disabled 
              style="opacity:0.5;cursor:not-allowed;">
              üîí Delete
            </button>`
          : `<button onclick="deleteMission()">Delete</button>`
      }

      <button onclick="closeModal()">Cancel</button>
    `;

    window.missionBeingEdited = skillDiv;
            }

            // ---- Add Skill ----
            if (type === "skill") {
                content.innerHTML = `
      <h3>Add Skill</h3>
      <input id="skillInput" placeholder="Skill name">
      <button onclick="addSkill()">Add</button>
      <button onclick="closeModal()">Cancel</button>
      `;
                //   <input id="progressInput" type="number" placeholder="Progress % (0-100)">
            }

            // ---- Edit Skill ----
            if (type === "edit-skill" && skillDiv) {
                const skillName = skillDiv.querySelector("strong").textContent;
                const currentProgress =
                    skillDiv.querySelector(".progress-bar").style.width.replace("%", "");

                content.innerHTML = `
      <h3>Edit ${skillName}</h3>
      <button onclick="deleteSkill('${skillName}')">Delete</button>
      <button onclick="closeModal()">Cancel</button>
    `;
            }

            // ---- Add Goal ----
            if (type === "goal") {
                content.innerHTML = `
    <h3>Add Goal</h3>
    <input id="goalInput" placeholder="Goal">

    <label>Priority</label>
    <select id="priorityInput">
      <option>High</option>
      <option>Medium</option>
      <option>Low</option>
    </select>

    <label>Deadline</label>
    <input id="goalDeadline" type="datetime-local">

    <button onclick="addGoal()">Add</button>
    <button onclick="closeModal()">Cancel</button>
  `;
            }


            // ---- Add Countdown (FIXED) ----
            if (type === "multi-time") {
                content.innerHTML = `
      <h3>Add Countdown</h3>
<input id="countdownTitle" placeholder="Title">
<input id="countdownDateTime" type="datetime-local">

<button onclick="addCountdown()">Add</button>
<button onclick="closeModal()">Cancel</button>

    `;
    const now = new Date().toISOString().slice(0, 16);
document.getElementById("countdownDateTime").min = now;

            }
        }

        // ---- FIXED: closeModal OUTSIDE openModal ----
        function closeModal() {
    document.getElementById("modal").classList.remove("active");

    // üî• RESET ALL MODAL INPUTS
    document.querySelectorAll("#modal input, #modal select").forEach(el => {
        el.value = "";
    });
}



        /* Alerts */
        function customAlert(msg) {
            document.getElementById("alertMsg").textContent = msg;
            document.getElementById("alertModal").classList.add("active");
        }

        function closeAlert() {
            document.getElementById("alertModal").classList.remove("active");
        }

        /* Confirm */
        let confirmCallback = null;

        function customConfirm(msg, callback) {
            confirmCallback = callback;
            document.getElementById("confirmMsg").textContent = msg;
            document.getElementById("confirmModal").classList.add("active");
        }

        function confirmYes() {
            if (confirmCallback) confirmCallback();
            document.getElementById("confirmModal").classList.remove("active");
        }

        function confirmNo() {
            document.getElementById("confirmModal").classList.remove("active");
        }


        /* =========================================================
           5. MISSIONS MODULE
        ========================================================= */
        const missionMilestones = [1, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50];

        function addMission() {
    const text = document.getElementById("missionInput").value.trim();
    const deadline = document.getElementById("missionDeadline").value;
    const linkedSkill = document.getElementById("linkedSkill").value;
    const isHardcore = document.getElementById("hardcoreToggle").checked;

    // ‚ùå Text required
    if (!text) {
        closeModal();
        return;
    }

    // üî• HARDCORE ‚Üí DEADLINE REQUIRED
    if (isHardcore && !deadline) {
        customAlert("üî• Hardcore missions require a deadline.");
        return;
    }

    // ‚ùå Past deadline not allowed
    if (deadline && isPastDateTime(deadline)) {
        customAlert("Deadline cannot be in the past.");
        return;
    }

    const li = document.createElement("li");
    li.dataset.deadline = deadline || "";
    li.dataset.skill = linkedSkill || "";
    li.dataset.completed = "false";
    li.dataset.hardcore = isHardcore ? "true" : "false";

    // Format deadline text
    let deadlineText = "";
    if (deadline) {
        const d = new Date(deadline);
        const date = d.toLocaleDateString([], { day: "numeric", month: "short" });
        const time = d.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" });
        deadlineText = `${date}, ${time}`;
    }

    li.innerHTML = `
        <span class="mission-text">
          ${text} ${isHardcore ? "üî•" : ""}
        </span>

        <div class="deadline-row">
            <span class="deadlineDisplay">${deadlineText}</span>
            <span class="overdueMark"></span>
            <button class="complete-btn" onclick="completeMission(this)">‚úî</button>
        </div>
    `;

    // Click to edit (except complete)
    li.addEventListener("click", (e) => {
        if (e.target.classList.contains("complete-btn")) return;
        openModal("edit-mission", li);
    });

    document.getElementById("mission-list").appendChild(li);
    saveData();
    closeModal();
        }






        setInterval(checkMissedDeadlines, 60000); // check every 1 minute

        function updateMission() {
    const li = window.missionBeingEdited;
    if (!li) return;

    const newText = document.getElementById("editMissionInput").value.trim();
    const newDeadline = document.getElementById("editMissionDeadline").value;
    const isHardcore = li.dataset.hardcore === "true";

    if (!newText) {
        closeModal();
        return;
    }

    // ‚ùå Hardcore ‚Üí deadline cannot change
    if (!isHardcore && newDeadline && isPastDateTime(newDeadline)) {
        customAlert("Deadline cannot be in the past.");
        return;
    }

    // ‚úÖ Restore üî• if hardcore
    li.querySelector(".mission-text").innerHTML =
        newText + (isHardcore ? " üî•" : "");

    // Update deadline ONLY if not hardcore
    if (!isHardcore) {
        if (newDeadline) {
            const d = new Date(newDeadline);
            const date = d.toLocaleDateString([], { day: "numeric", month: "short" });
            const time = d.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" });

            li.querySelector(".deadlineDisplay").textContent = `${date}, ${time}`;
            li.dataset.deadline = newDeadline;
        } else {
            li.querySelector(".deadlineDisplay").textContent = "";
            li.dataset.deadline = "";
        }

        // Reset overdue state if deadline changed
        li.querySelector(".overdueMark").innerHTML = "";
        delete li.dataset.deducted;
    }

    saveData();
    closeModal();
        }
        

        
function checkMissedDeadlines() {
    const missions = document.querySelectorAll("#mission-list li");
    const now = Date.now();

    missions.forEach(li => {
        const deadline = li.dataset.deadline;
        if (!deadline) return;

        if (li.dataset.completed === "true") return;

        const deadlineTime = new Date(deadline).getTime();
        const timeLeft = deadlineTime - now;

        const overdueSpan = li.querySelector(".overdueMark");
        if (!overdueSpan) return;

        // üîî Due soon warning (once)
        if (
            timeLeft > 0 &&
            timeLeft <= 2 * 60 * 60 * 1000 &&
            !li.dataset.warned
        ) {
            li.dataset.warned = "true";
            pushNotification(
                "Mission Deadline",
                `"${li.querySelector('.mission-text').textContent}" is due soon (within 2 hours!)`
            );
        }

        // ‚è∞ DEADLINE PASSED
        if (timeLeft <= 0) {
            overdueSpan.innerHTML = `<span class="overdue-badge">Overdue</span>`;

            // üîî Notify overdue (once)
            if (!li.dataset.overdueNotified) {
                li.dataset.overdueNotified = "true";
                pushNotification(
                    "‚ö† Mission Overdue",
                    `"${li.querySelector('.mission-text').textContent}" is overdue!`
                );
            }

            // üî• HARDCORE MODE ‚Äî RESET ALL POINTS (ONCE)
            if (
                li.dataset.hardcore === "true" &&
                !li.dataset.hardcorePunished
            ) {
                li.dataset.hardcorePunished = "true";

                completedMissions = 0;
                localStorage.setItem("completedMissions", 0);
                document.getElementById("missionCounter").textContent = "0";

                renderMarketplace();
                renderMyCards();

                showSmartNotification(
                    "üî• Hardcore Failed",
                    "Improvement Points reset to ZERO."
                );

                saveData();
                return; // ‚õî stop further penalties
            }

            // ‚ùå NORMAL MODE ‚Äî DEDUCT 1 POINT (ONCE)
            if (!li.dataset.deducted) {
                completedMissions = Math.max(0, completedMissions - 1);
                li.dataset.deducted = "true";

                document.getElementById("missionCounter").textContent = completedMissions;
                localStorage.setItem("completedMissions", completedMissions);

                saveData();
            }
        }
    });
}


        function deleteMission() {
    const li = window.missionBeingEdited;
    if (!li) return;

    if (li.dataset.hardcore === "true") {
        const deadline = li.dataset.deadline;
        const now = Date.now();

        if (deadline && new Date(deadline).getTime() <= now) {
            customAlert("üî• Hardcore missions cannot be deleted after deadline.");
            return;
        }

        customConfirm(
            "üî• This is a Hardcore mission.\nDelete only if created by mistake?",
            () => {
                li.remove();
                saveData();
                closeModal();
            }
        );
        return;
    }

    // Normal mission
    li.remove();
    saveData();
    closeModal();
        }


        function completeMission(btn) {
    resetDailyImprovementIfNeeded();

    const li = btn.closest("li");
    const linkedSkill = li.dataset.skill;
    const deadline = li.dataset.deadline;

    li.classList.add("remove");
    li.dataset.completed = "true";
    setTimeout(() => li.remove(), 400);

    // ‚ùå OVERDUE ‚Üí NO GAIN
    if (deadline && new Date(deadline).getTime() < Date.now()) {
        showPopup("Mission was overdue. No improvement points gained.");
        saveData();
        return;
    }

    // ‚ùå DAILY LIMIT REACHED
    if (dailyImprovementCount >= DAILY_IMPROVEMENT_LIMIT) {
        showPopup("You're too tired today. No improvement points gained.");
        saveData();
        return;
    }

    // ‚úÖ SUCCESSFUL COMPLETION
    dailyImprovementCount++;
    completedMissions++;

    localStorage.setItem("dailyImprovementCount", dailyImprovementCount);
    localStorage.setItem("completedMissions", completedMissions);

    document.getElementById("missionCounter").textContent = completedMissions;

    if (linkedSkill) {
        increaseSkillXP(linkedSkill, 1);
    }

    checkMissionAchievements();
    showPopup("Mission completed! Improvement point gained.");
    saveData();
}



        function increaseSkillXP(skillName, amount) {
            const skills = document.querySelectorAll("#skill-list .skill");

            skills.forEach(skill => {
                const name = skill.querySelector("strong").textContent.trim();

                if (name === skillName.trim()) {
                    let xp = parseInt(skill.dataset.xp || "0");
                    xp = Math.min(100, xp + amount);

                    skill.dataset.xp = xp;
                    skill.setAttribute("data-xp", xp);

                    skill.querySelector(".xp-count").textContent = xp;
                    skill.querySelector(".progress-bar").style.width = xp + "%";

                    saveData(); // üî• force persist
                }
            });
        }



        function checkMissionAchievements() {
            missionMilestones.forEach(m => {
                if (completedMissions === m) unlockAchievement("mission" + m);
            });
        }

        function showPopup(achievementText) {
            const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];

            document.getElementById("motivationQuote").innerText = randomQuote;
            document.getElementById("achievement").innerText = achievementText;

            const popup = document.getElementById("motivationPopup");
            popup.style.display = "flex";

            if (!window.isAchievementPlaying) {
                const sound = document.getElementById("popupSound");
                sound.currentTime = 0;
                sound.volume = 1.0;
                sound.play().catch(() => { });
            }
        }

        function closePopup() {
            const popup = document.getElementById("motivationPopup");
            const content = popup.querySelector(".popup-content");

            content.style.animation = "fadeOut 0.3s ease forwards";

            setTimeout(() => {
                popup.style.display = "none";
                content.style.animation = "popIn 0.4s ease forwards";
            }, 300);
        }


        /* =========================================================
           6. SKILLS MODULE
        ========================================================= */
        function addSkill() {
            const skill = document.getElementById("skillInput").value;
            if (!skill) return closeModal();

            const div = document.createElement("div");
            div.className = "skill show";
            div.dataset.xp = "0"; // üî• XP starts at 0

            div.innerHTML = `
        <strong>${skill}</strong>
        <div class="progress">
            <div class="progress-bar" style="width:0%"></div>
        </div>
        <small>XP: <span class="xp-count">0</span></small>
        <button class="remove-btn" onclick="deleteSkillDirect(this)">Remove</button>
        `;

            document.getElementById("skill-list").appendChild(div);
            saveData();
            closeModal();
        }

        function deleteSkillDirect(btn) {
            const skillDiv = btn.closest(".skill");
            const skillName = skillDiv.querySelector("strong").textContent;

            customConfirm(
                `Delete skill "${skillName}"?\nLinked missions will stop giving XP.`,
                () => {
                    skillDiv.remove();

                    // Remove skill link from missions
                    document.querySelectorAll("#mission-list li").forEach(li => {
                        if (li.dataset.skill === skillName) {
                            li.dataset.skill = "";
                        }
                    });

                    saveData();
                }
            );
        }


        // function updateSkillProgress(skillName) {
        //     let newProgress = document.getElementById("editProgressInput").value;
        //     newProgress = Math.min(100, Math.max(0, parseInt(newProgress)));

        //     const skills = document.querySelectorAll("#skill-list .skill");
        //     skills.forEach(skill => {
        //         if (skill.querySelector("strong").textContent === skillName) {
        //             skill.querySelector(".progress-bar").style.width = newProgress + "%";
        //         }
        //     });

        //     saveData();
        //     closeModal();
        // }

        function deleteSkill(skillName) {
            const skills = document.querySelectorAll("#skill-list .skill");
            skills.forEach(skill => {
                if (skill.querySelector("strong").textContent === skillName) skill.remove();
            });

            saveData();
            closeModal();
        }


        /* =========================================================
           7. GOALS MODULE
        ========================================================= */
        function addGoal() {
            const goalText = document.getElementById("goalInput").value;
            const priority = document.getElementById("priorityInput").value;
            const deadline = document.getElementById("goalDeadline").value;

            if (isPastDateTime(deadline)) {
                customAlert("Deadline cannot be in the past.");
                return;
            }


            if (!goalText) {
                closeModal();
                return;
            }

            // Create goal div
            const div = document.createElement("div");
            div.className = "goal show";
            div.dataset.deadline = deadline;

            // Format deadline
            let formattedDeadline = "";
            if (deadline) {
                const d = new Date(deadline);
                formattedDeadline = d.toLocaleDateString([], { day: "numeric", month: "short" });
            }

            // Fill goal card UI
            div.innerHTML = `
        <div class="goal-header">
            <span class="goal-title">${goalText} -</span>
            <span class="goal-priority ${priority}"><strong>${priority}</strong></span>
        </div>

        <div class="goal-subrow">
            <span class="goal-deadline">${formattedDeadline}</span>
            <span class="goal-overdue"></span>
            <button class="remove-btn" onclick="removeGoal(this)">Remove</button>
        </div>

        <div class="goal-timer" style="margin-top:6px; font-size:14px; opacity:.9;"></div>
    `;

            // Add to list
            document.getElementById("goal-list").appendChild(div);

            saveData();
            closeModal();

        }
        function updateGoalTimers() {
            const goals = document.querySelectorAll("#goal-list .goal");

            goals.forEach(goal => {
                const deadline = goal.dataset.deadline;
                if (!deadline) return;

                const timer = goal.querySelector(".goal-timer");
                const overdueBadge = goal.querySelector(".goal-overdue");

                const diff = new Date(deadline).getTime() - Date.now();

                if (diff > 0) {
                    const hours = Math.floor(diff / (1000 * 60 * 60));
                    const minutes = Math.floor((diff / (1000 * 60)) % 60);

                    timer.textContent = `${hours}h ${minutes}m left`;
                    overdueBadge.innerHTML = "";

                    if (diff <= 2 * 60 * 60 * 1000 && !goal.dataset.warned) {
                        goal.dataset.warned = "true";
                        pushNotification(
                            "Goal Reminder",
                            `Your goal "${goal.querySelector('.goal-title').textContent}" is due soon (within 2 hours).`
                        );
                    }

                } else {
                    timer.textContent = "";
                    overdueBadge.innerHTML = `<span class="overdue-badge">Overdue</span>`;

                    if (!goal.dataset.overdueNotified) {
                        goal.dataset.overdueNotified = "true";

                        pushNotification(
                            "‚ö† Goal Overdue",
                            `"${goal.querySelector('.goal-title').textContent}" deadline has passed!`
                        );
                    }
                }
            });
        }

        // Run every second
        setInterval(updateGoalTimers, 1000);



        function removeGoal(btn) {
            const goalDiv = btn.closest(".goal");
            if (goalDiv) {
                goalDiv.remove();
                saveData();
            }
        }



        /* =========================================================
           8. COUNTDOWNS MODULE
        ========================================================= */
        let countdowns = JSON.parse(localStorage.getItem("countdowns")) || [];

        function saveCountdowns() {
            localStorage.setItem("countdowns", JSON.stringify(countdowns));
        }

        function addCountdown() {
    const titleInput = document.getElementById("countdownTitle");
    const timeInput = document.getElementById("countdownDateTime");

    const title = titleInput.value.trim();
    const dateTime = timeInput.value;

    // ‚ùå EMPTY CHECK
    if (!title || !dateTime) {
        closeModal();
        return;
    }

    // ‚ùå PAST TIME CHECK (HARD STOP)
    if (isPastDateTime(dateTime)) {
        customAlert("Countdown time cannot be in the past.");
        return; // üî• DO NOT CONTINUE
    }

    // ‚úÖ ONLY NOW MUTATE STATE
    countdowns.push({
        title,
        date: new Date(dateTime).toISOString(),
        startTime: new Date().toISOString()
    });

    saveCountdowns();
    renderCountdowns();

    // üî• CLEANUP
    titleInput.value = "";
    timeInput.value = "";

    closeModal();
}





        function removeCountdown(index) {
            countdowns.splice(index, 1);
            saveCountdowns();
            renderCountdowns();
        }

        function renderCountdowns() {
            const list = document.getElementById("countdown-list");
            list.innerHTML = "";

            document.getElementById("countdownCounter").textContent = countdowns.length;

            if (countdowns.length === 0) {
                list.textContent = "No countdowns added";
                return;
            }

            countdowns.forEach((c, index) => {
                const div = document.createElement("div");
                div.className = "goal show";

                div.innerHTML = `
      <strong>${c.title}</strong>
      <div class="timer-row">
  <div class="timer-bar-container">
    <div class="timer-bar" id="timerbar-${index}"></div>
  </div>
  <div class="timer-text" id="timer-${index}"></div>
</div>
      <button class="remove-btn2" onclick="removeCountdown(${index})">Remove</button>
    `;

                list.appendChild(div);
            });

            updateTimers();
        }


        function updateTimers() {
            clearInterval(window.timerInterval);

            window.timerInterval = setInterval(() => {
                countdowns.forEach((c, index) => {
                    const now = new Date().getTime();
                    const target = new Date(c.date).getTime();
                    const diff = target - now;

                    const totalDuration = target - new Date(countdowns[index].startTime || c.date).getTime();
                    const remaining = diff;

                    let percent = (remaining / totalDuration) * 100;

                    // clamp values
                    if (percent < 0) percent = 0;
                    if (percent > 100) percent = 100;

                    const bar = document.getElementById(`timerbar-${index}`);
                    if (bar) bar.style.width = percent + "%";
                    // Notify when 1 hour left
                    if (diff > 0 && diff <= 60 * 60 * 1000 && !c.warned) {
                        c.warned = true;
                        pushNotification("Countdown Ending Soon", `"${c.title}" ends in 1 hour`);
                    }


                    const el = document.getElementById(`timer-${index}`);
                    if (!el) return;

                    if (diff <= 0) {
                        el.style.color = "red";
                        el.textContent = "Time's up!";
                        return;
                    }

                    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const mins = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                    const secs = Math.floor((diff % (1000 * 60)) / 1000);

                    el.textContent = `${days}d ${hours}h ${mins}m ${secs}s`;
                });
            }, 1000);
        }




        /* =========================================================
           9. RESET & DATA MANAGEMENT
        ========================================================= */
        function saveData() {
            localStorage.setItem("completedMissions", completedMissions);
            localStorage.setItem("missionHistory", JSON.stringify(missionHistory));
            // Save deducted flag on missions
            document.querySelectorAll("#mission-list li").forEach(li => {
                if (li.dataset.deducted) {
                    li.setAttribute("data-deducted", "true");
                }
            });


            // üî• STORE XP INTO HTML ATTRIBUTES
            document.querySelectorAll("#skill-list .skill").forEach(skill => {
                skill.setAttribute("data-xp", skill.dataset.xp || "0");
            });

            localStorage.setItem("missions", document.getElementById("mission-list").innerHTML);
            localStorage.setItem("skills", document.getElementById("skill-list").innerHTML);
            localStorage.setItem("goals", document.getElementById("goal-list").innerHTML);

            document.querySelectorAll("#mission-list li").forEach(li => {
                if (li.dataset.overdueNotified) {
                    li.setAttribute("data-overdue-notified", "true");
                }
            });

        }

        function loadData() {
    document.getElementById("mission-list").innerHTML =
        localStorage.getItem("missions") || "";
    document.getElementById("skill-list").innerHTML =
        localStorage.getItem("skills") || "";
    document.getElementById("goal-list").innerHTML =
        localStorage.getItem("goals") || "";

    // --- FIX MISSIONS AFTER LOADING ---
    document.querySelectorAll("#mission-list li").forEach(li => {

        // 1. Ensure overdueMark exists
        if (!li.querySelector(".overdueMark")) {
            const span = document.createElement("span");
            span.className = "overdueMark";
            li.appendChild(span);
        }

        // 2. Ensure deadlineDisplay exists
        if (!li.querySelector(".deadlineDisplay")) {
            const dspan = document.createElement("span");
            dspan.className = "deadlineDisplay";
            li.appendChild(dspan);
        }

        // 3. Restore deadline
        const savedDeadline = li.getAttribute("data-deadline");
        if (savedDeadline) li.dataset.deadline = savedDeadline;

        // 4. Restore deducted flag
        if (li.getAttribute("data-deducted") === "true") {
            li.dataset.deducted = "true";
        }

        // 5. Restore overdue notification flag
        if (li.getAttribute("data-overdue-notified") === "true") {
            li.dataset.overdueNotified = "true";
        }

        // ===============================
        // üî• HARDCORE MODE RESTORE (NEW)
        // ===============================
        if (li.getAttribute("data-hardcore") === "true") {
            li.dataset.hardcore = "true";
        }

        if (li.getAttribute("data-hardcore-punished") === "true") {
            li.dataset.hardcorePunished = "true";
        }
        // ===============================

        // 6. Reattach edit modal click
        li.addEventListener("click", (e) => {
            if (e.target.classList.contains("complete-btn")) return;
            openModal("edit-mission", li);
        });
    });

    // ---- SKILLS ----
    document.querySelectorAll("#skill-list .skill").forEach(div => {
        div.addEventListener("click", () => openModal("edit-skill", div));
        div.classList.add("show");
    });

    // ---- GOALS ----
    document.querySelectorAll("#goal-list .goal").forEach(div => {
        div.classList.add("show");
        const removeBtn = div.querySelector(".remove-btn");
        if (removeBtn) {
            removeBtn.onclick = () => removeGoal(removeBtn);
        }
    });

    // ---- SKILL XP ----
    document.querySelectorAll("#skill-list .skill").forEach(skill => {
        const xp = parseInt(skill.getAttribute("data-xp") || "0");
        skill.dataset.xp = xp;
        skill.querySelector(".xp-count").textContent = xp;
        skill.querySelector(".progress-bar").style.width = xp + "%";
    });
}

        
        function resetData() {
            // ===============================
            // 1. RESET RUNTIME MEMORY (üî• IMPORTANT)
            // ===============================
            completedMissions = 0;
            appNotifications = [];

            dailyImprovementCount = 0;
lastImprovementDate = new Date().toDateString();

localStorage.removeItem("dailyImprovementCount");
localStorage.removeItem("lastImprovementDate");


// RESET COUNTDOWNS
countdowns = [];
localStorage.removeItem("countdowns");

if (window.timerInterval) {
    clearInterval(window.timerInterval);
    window.timerInterval = null;
}

document.getElementById("countdown-list").innerHTML = "";
document.getElementById("countdownCounter").textContent = "0";



            // Reset achievements in memory
            achievementsData = achievements.map(a => ({ ...a, unlocked: false }));

            // ===============================
            // RESET MARKETPLACE
            // ===============================
            ownedCards = {};
            localStorage.removeItem("ownedCards");

            // Re-render marketplace UI
            renderMarketplace();
            renderMyCards();
            // ===============================
            // 2. CLEAR LOCAL STORAGE
            // ===============================
            localStorage.removeItem("missions");
            localStorage.removeItem("completedMissions");
            localStorage.removeItem("missionHistory");
            localStorage.removeItem("goals");
            localStorage.removeItem("skills");
            localStorage.removeItem("countdowns");
            localStorage.removeItem("achievements");
            localStorage.removeItem("appNotifications");
            localStorage.removeItem("lastNotifCount");

            // Extra safety cleanup
            Object.keys(localStorage).forEach(key => {
                if (
                    key.startsWith("mission") ||
                    key.startsWith("goal") ||
                    key.includes("timer") ||
                    key.includes("notif")
                ) {
                    localStorage.removeItem(key);
                }
            });

            // ===============================
            // 3. RESET UI (üî• ALSO REQUIRED)
            // ===============================
            document.getElementById("missionCounter").textContent = "0";
            document.getElementById("countdownCounter").textContent = "0";

            document.getElementById("mission-list").innerHTML = "";
            document.getElementById("skill-list").innerHTML = "";
            document.getElementById("goal-list").innerHTML = "";
            document.getElementById("countdown-list").innerHTML = "";

            // Reset notifications UI
            const notifList = document.getElementById("notificationList");
            if (notifList) {
                notifList.innerHTML = `<p style="opacity:0.6;">No notifications</p>`;
            }

            const badge = document.getElementById("notifyBadge");
            if (badge) {
                badge.style.display = "none";
                badge.textContent = "";
            }

            // Save reset achievements back
            localStorage.setItem("achievements", JSON.stringify(achievementsData));
            renderAchievements();

            customAlert("All data has been reset successfully!");
        }


        function isPastDateTime(dateTimeValue) {
            if (!dateTimeValue) return false; // allow empty deadlines
            return new Date(dateTimeValue).getTime() < Date.now();
        }


        /* =========================================================
           10. INITIALIZATION
        ========================================================= */
        window.addEventListener("load", () => {
            resetDailyImprovementIfNeeded()
            renderAchievements();
            renderCountdowns();
            loadData();
            

            const activePage = document.querySelector("section.active")
                ? document.querySelector("section.active").id
                : "missions";

            showPage(activePage);
        });

        document.querySelectorAll("#goal-list .goal").forEach(div => {
            div.classList.add("show");
            const removeBtn = div.querySelector(".remove-btn");
            if (removeBtn) {
                removeBtn.onclick = () => removeGoal(removeBtn);
            }
        });

        //Cheats

      let resetHoldTimer = null;
const RESET_HOLD_DURATION = 5000; // 5 seconds

const resetBtn = document.getElementById("resetDataBtn"); // your reset button ID

resetBtn.addEventListener("touchstart", startResetHold);
resetBtn.addEventListener("mousedown", startResetHold);

resetBtn.addEventListener("touchend", cancelResetHold);
resetBtn.addEventListener("mouseup", cancelResetHold);
resetBtn.addEventListener("mouseleave", cancelResetHold);

function startResetHold() {
    resetHoldTimer = setTimeout(() => {
        openCheatModal();
        if (navigator.vibrate) navigator.vibrate(80);
    }, RESET_HOLD_DURATION);
}

function cancelResetHold() {
    clearTimeout(resetHoldTimer);
}
        function openCheatModal() {
    const modal = document.getElementById("cheatModal");
    modal.classList.add("active");

    setTimeout(() => {
        document.getElementById("cheatInput").focus();
    }, 150);
        }

function closeCheatModal() {
    document.getElementById("cheatModal").classList.remove("active");
}

        function confirmCheat() {
    const code = document.getElementById("cheatInput").value.trim();

    if (code !== "Thala") {
        customAlert("Invalid cheat code.");
        return;
    }
   if (navigator.vibrate) navigator.vibrate(80);
    // ‚úÖ CHEAT SUCCESS
    completedMissions = 9999;
    dailyImprovementCount = 0;

    localStorage.setItem("completedMissions", completedMissions);
    document.getElementById("missionCounter").textContent = completedMissions;

    closeCheatModal();

    showSmartNotification(
        "Cheat Activated",
        "9999 Improvement Points granted."
    );
        }

    </script>


</body>

</html>











































